{"ast":null,"code":"import _objectSpread from\"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect}from'react';import{Button}from'./ui/button';import{Card,CardContent}from'./ui/card';import{Textarea}from'./ui/textarea';import{Badge}from'./ui/badge';import{Avatar,AvatarFallback}from'./ui/avatar';import{Sparkles,Upload,X,Send,Video,CheckCircle,XCircle,TrendingUp,Wand2,Zap,Loader2,AlertCircle,ThumbsUp,ThumbsDown,Clock,Scissors,User,Film,Clapperboard}from'lucide-react';import{toast}from'sonner';import{useNavigate}from'react-router-dom';import{uploadVideoChunked,analyzeVideo,sendChatMessage,getChatHistory,handleSuggestionAction,createDirectorProject,sendDirectorMessage,uploadDirectorSegment,getDirectorProject}from'../utils/api';import{VideoTimeline}from'./VideoTimeline';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export const WorkspaceEnhanced=()=>{const navigate=useNavigate();const[messages,setMessages]=useState([]);const[inputValue,setInputValue]=useState('');const[uploadedVideo,setUploadedVideo]=useState(null);const[uploadProgress,setUploadProgress]=useState(0);const[isUploading,setIsUploading]=useState(false);const[isAnalyzing,setIsAnalyzing]=useState(false);const[isProcessing,setIsProcessing]=useState(false);const[isDragging,setIsDragging]=useState(false);const[currentSuggestions,setCurrentSuggestions]=useState([]);const[trendingFormat,setTrendingFormat]=useState(null);const[isWorkspaceActive,setIsWorkspaceActive]=useState(false);// Director mode state\nconst[directorMode,setDirectorMode]=useState(false);const[directorProject,setDirectorProject]=useState(null);const[shotList,setShotList]=useState([]);const[matchedFormat,setMatchedFormat]=useState(null);const fileInputRef=useRef(null);const textareaRef=useRef(null);const messagesEndRef=useRef(null);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};useEffect(()=>{scrollToBottom();},[messages]);// Load chat history on mount\nuseEffect(()=>{loadChatHistory();},[]);const loadChatHistory=async()=>{try{const history=await getChatHistory();if(history.messages&&history.messages.length>0){const formattedMessages=history.messages.map(msg=>({role:msg.role,content:msg.content,timestamp:new Date(msg.timestamp)}));setMessages(formattedMessages);}else{// Add welcome message if no history\nsetMessages([{role:'assistant',content:'ðŸŽ¬ Hey! I\\'m your AI Director powered by LangGraph!\\n\\n**Two modes available:**\\n\\nðŸŽ¥ **Director Mode** - I\\'ll guide you step-by-step to create viral videos:\\n  â€¢ Match you with proven viral formats (YC Demo, Cluely Launch, etc.)\\n  â€¢ Create custom shot lists and scripts\\n  â€¢ Guide you through recording each segment\\n  â€¢ Edit and optimize your final video\\n\\nJust say \"Start Director Mode\" to begin!\\n\\nðŸ“¹ **Quick Analysis** - Upload existing footage for instant AI analysis and suggestions.\\n\\nWhat would you like to do?',timestamp:new Date()}]);}}catch(error){console.error('Error loading chat history:',error);setMessages([{role:'assistant',content:'ðŸŽ¬ Hey! I\\'m your personal director. Upload footage or tell me your content idea, and I\\'ll help you create viral content!',timestamp:new Date()}]);}};const quickPrompts=[{icon:/*#__PURE__*/_jsx(Film,{className:\"w-4 h-4\"}),text:'What content should I create?',color:'bg-primary/10 text-primary border-primary/20'},{icon:/*#__PURE__*/_jsx(Scissors,{className:\"w-4 h-4\"}),text:'Help me edit my footage',color:'bg-secondary/10 text-secondary border-secondary/20'},{icon:/*#__PURE__*/_jsx(TrendingUp,{className:\"w-4 h-4\"}),text:'What\\'s trending right now?',color:'bg-accent/20 text-foreground border-accent/30'}];const handleFileSelect=async e=>{const files=Array.from(e.target.files||[]);if(files.length>0){await handleVideoUpload(files[0]);}};const handleVideoUpload=async file=>{if(!file.type.startsWith('video/')){toast.error('Please upload a video file');return;}setIsUploading(true);setUploadProgress(0);try{const result=await uploadVideoChunked(file,progress=>{setUploadProgress(progress.percentage);});setUploadedVideo({id:result.video_metadata.id,name:file.name,size:(file.size/1024/1024).toFixed(2),url:URL.createObjectURL(file)});toast.success('Video uploaded! ðŸŽ‰',{description:'Ready for AI analysis'});// Activate workspace\nif(!isWorkspaceActive){setIsWorkspaceActive(true);}// Add system message\nconst systemMessage={role:'system',content:\"\\uD83D\\uDCF9 Video \\\"\".concat(file.name,\"\\\" (\").concat((file.size/1024/1024).toFixed(2),\" MB) uploaded successfully! Ready to analyze.\"),timestamp:new Date()};setMessages(prev=>[...prev,systemMessage]);}catch(error){console.error('Upload error:',error);toast.error('Upload failed',{description:error.message||'Please try again'});}finally{setIsUploading(false);setUploadProgress(0);}};const handleDragOver=e=>{e.preventDefault();setIsDragging(true);};const handleDragLeave=e=>{e.preventDefault();setIsDragging(false);};const handleDrop=e=>{e.preventDefault();setIsDragging(false);const files=Array.from(e.dataTransfer.files);if(files.length>0&&files[0].type.startsWith('video/')){handleVideoUpload(files[0]);}else{toast.error('Please drop a video file');}};const removeVideo=()=>{setUploadedVideo(null);setCurrentSuggestions([]);setTrendingFormat(null);toast.success('Video removed');};const handleAnalyzeVideo=async()=>{if(!uploadedVideo){toast.error('Please upload a video first');return;}if(!inputValue.trim()){toast.error('Please describe your content goals');return;}setIsAnalyzing(true);setIsProcessing(true);// Add user message\nconst userMessage={role:'user',content:inputValue.trim(),timestamp:new Date()};setMessages(prev=>[...prev,userMessage]);setInputValue('');try{toast.loading('Analyzing your video...',{id:'analysis'});const result=await analyzeVideo(uploadedVideo.id,inputValue.trim(),null);toast.success('Analysis complete! ðŸŽ¯',{id:'analysis'});// Format AI response\nconst aiResponse=formatAnalysisResponse(result);const aiMessage={role:'assistant',content:aiResponse,timestamp:new Date(),suggestions:result.suggestions,format:result.recommended_format};setMessages(prev=>[...prev,aiMessage]);// Store suggestions\nsetCurrentSuggestions(result.suggestions||[]);setTrendingFormat(result.recommended_format);}catch(error){console.error('Analysis error:',error);toast.error('Analysis failed',{id:'analysis',description:error.message});const errorMessage={role:'assistant',content:'âŒ Sorry, I encountered an error analyzing your video. Please try again or contact support if the issue persists.',timestamp:new Date()};setMessages(prev=>[...prev,errorMessage]);}finally{setIsAnalyzing(false);setIsProcessing(false);}};const formatAnalysisResponse=result=>{const format=result.recommended_format;const reasoning=result.format_reasoning;const suggestions=result.suggestions||[];const hashtags=result.trending_hashtags_used||[];let response=\"\\uD83C\\uDFAC **Video Analysis Complete!**\\n\\n\";response+=\"\\uD83D\\uDCCA **Recommended Format: \\\"\".concat((format===null||format===void 0?void 0:format.name)||'Custom',\"\\\"**\\n\");response+=\"\".concat(reasoning,\"\\n\\n\");response+=\"**Format Structure:** \".concat((format===null||format===void 0?void 0:format.structure)||'N/A',\"\\n\\n\");response+=\"\\uD83D\\uDCA1 **AI Suggestions (\".concat(suggestions.length,\"):**\\n\");response+=\"I've generated \".concat(suggestions.length,\" actionable suggestions below. Review each one and accept the ones that resonate with your vision!\\n\\n\");if(hashtags.length>0){response+=\"\\uD83D\\uDD25 **Trending Hashtags:**\\n\";response+=hashtags.map(h=>\"#\".concat(h.hashtag)).join(' ')+'\\n\\n';}response+=\"\\uD83D\\uDC47 Scroll down to see all suggestions with accept/reject buttons.\";return response;};const handleSendMessage=async()=>{if(!inputValue.trim()){return;}// Activate workspace on first interaction\nif(!isWorkspaceActive){setIsWorkspaceActive(true);}const userMessageText=inputValue.trim();// Check if user wants to start Director mode\nif(userMessageText.toLowerCase().includes('director mode')||userMessageText.toLowerCase().includes('start director')){await startDirectorMode(userMessageText);return;}// If in Director mode, route to Director\nif(directorMode&&directorProject){await handleDirectorMessage(userMessageText);return;}// If video is uploaded but not analyzed yet, trigger analysis\nif(uploadedVideo&&currentSuggestions.length===0){handleAnalyzeVideo();return;}setIsProcessing(true);const userMessage={role:'user',content:userMessageText,timestamp:new Date()};setMessages(prev=>[...prev,userMessage]);setInputValue('');try{const result=await sendChatMessage(userMessage.content,uploadedVideo===null||uploadedVideo===void 0?void 0:uploadedVideo.id);const aiMessage={role:'assistant',content:result.response,timestamp:new Date(result.timestamp)};setMessages(prev=>[...prev,aiMessage]);}catch(error){console.error('Chat error:',error);toast.error('Failed to send message');}finally{setIsProcessing(false);}};// Start Director Mode\nconst startDirectorMode=async initialMessage=>{setIsProcessing(true);setInputValue('');const userMessage={role:'user',content:initialMessage,timestamp:new Date()};setMessages(prev=>[...prev,userMessage]);try{// Ask user for their goal\nconst aiMessage={role:'assistant',content:'ðŸŽ¬ **Director Mode Activated!**\\n\\nLet\\'s create something viral together! Tell me:\\n\\n1. What do you want to create? (e.g., \"A demo video for my language learning app\")\\n2. Who is your target audience? (e.g., \"College students on TikTok\")\\n3. What platform? (TikTok, Instagram, YouTube)\\n\\nDescribe your video idea and I\\'ll match you with the perfect viral format!',timestamp:new Date()};setMessages(prev=>[...prev,aiMessage]);setDirectorMode('awaiting_goal');}catch(error){console.error('Error starting Director mode:',error);toast.error('Failed to start Director mode');}finally{setIsProcessing(false);}};// Handle Director message\nconst handleDirectorMessage=async message=>{setIsProcessing(true);setInputValue('');const userMessage={role:'user',content:message,timestamp:new Date()};setMessages(prev=>[...prev,userMessage]);try{let result;// If no project yet, create one\nif(!directorProject){result=await createDirectorProject(message,'general','TikTok');setDirectorProject(result);setDirectorMode(true);// Update state from result\nif(result.matched_format){setMatchedFormat(result.matched_format);}if(result.shot_list){setShotList(result.shot_list);}}else{// Continue existing project\nresult=await sendDirectorMessage(directorProject.project_id,message);// Update state from result\nif(result.shot_list){setShotList(result.shot_list);}if(result.matched_format){setMatchedFormat(result.matched_format);}}const aiMessage={role:'assistant',content:result.message,timestamp:new Date()};setMessages(prev=>[...prev,aiMessage]);}catch(error){console.error('Director error:',error);toast.error('Failed to process Director message');}finally{setIsProcessing(false);}};const handleSuggestionAccept=async suggestion=>{try{await handleSuggestionAction(suggestion.id,'accept');// Update local state\nsetCurrentSuggestions(prev=>prev.map(s=>s.id===suggestion.id?_objectSpread(_objectSpread({},s),{},{status:'accepted'}):s));toast.success('Suggestion accepted! âœ…',{description:suggestion.title});}catch(error){toast.error('Failed to accept suggestion');}};const handleSuggestionReject=async suggestion=>{try{await handleSuggestionAction(suggestion.id,'reject');// Update local state\nsetCurrentSuggestions(prev=>prev.map(s=>s.id===suggestion.id?_objectSpread(_objectSpread({},s),{},{status:'rejected'}):s));toast.success('Suggestion rejected',{description:'Removed from your list'});}catch(error){toast.error('Failed to reject suggestion');}};const handleQuickPrompt=promptText=>{var _textareaRef$current;setInputValue(promptText);(_textareaRef$current=textareaRef.current)===null||_textareaRef$current===void 0?void 0:_textareaRef$current.focus();};const handleKeyDown=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSendMessage();}};const getSuggestionIcon=type=>{switch(type){case'script':return'ðŸ“';case'text_overlay':return'ðŸ’¬';case'shot':return'ðŸŽ¥';case'timestamp':return'â±ï¸';case'format':return'ðŸŽ¬';case'audio':return'ðŸŽµ';case'bgm':return'ðŸŽ§';case'example_video':return'ðŸŒŸ';default:return'âœ¨';}};const formatTimestamp=seconds=>{if(!seconds&&seconds!==0)return'00:00';const mins=Math.floor(seconds/60);const secs=Math.floor(seconds%60);return\"\".concat(mins.toString().padStart(2,'0'),\":\").concat(secs.toString().padStart(2,'0'));};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-sky relative overflow-hidden gradient-bg-dynamic\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"gradient-orb-1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"gradient-orb-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"gradient-orb-3\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 pointer-events-none overflow-hidden z-10\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"floating-sticker top-20 left-[8%] text-5xl animate-float\",style:{animationDelay:'0s'},children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"div\",{className:\"floating-sticker top-32 right-[12%] text-4xl animate-float\",style:{animationDelay:'1.5s'},children:\"\\uD83C\\uDFAC\"}),/*#__PURE__*/_jsx(\"div\",{className:\"floating-sticker bottom-32 left-[15%] text-4xl animate-float\",style:{animationDelay:'3s'},children:\"\\uD83D\\uDE80\"}),/*#__PURE__*/_jsx(\"div\",{className:\"floating-sticker top-[45%] right-[20%] text-3xl animate-float\",style:{animationDelay:'2s'},children:\"\\uD83D\\uDCA1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"floating-sticker bottom-24 right-[8%] text-4xl animate-float\",style:{animationDelay:'2.5s'},children:\"\\u26A1\"}),/*#__PURE__*/_jsx(\"div\",{className:\"floating-sticker top-[60%] left-[5%] text-3xl animate-float\",style:{animationDelay:'1s'},children:\"\\uD83C\\uDFAF\"})]}),/*#__PURE__*/_jsx(\"nav\",{className:\"border-b border-border/50 bg-background/80 backdrop-blur-md sticky top-0 z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center h-16\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/'),className:\"flex items-center gap-2 hover:opacity-80 transition-opacity\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-5xl font-logo font-bold text-foreground\",children:\"Trendle\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[directorMode?/*#__PURE__*/_jsxs(Badge,{className:\"hidden sm:flex bg-primary/20 text-primary border-primary/30 hover:bg-primary/30 font-sans animate-pulse\",children:[/*#__PURE__*/_jsx(Film,{className:\"w-3 h-3 mr-1\"}),\"Director Mode\"]}):/*#__PURE__*/_jsxs(Badge,{className:\"hidden sm:flex bg-accent/20 text-foreground border-accent/30 hover:bg-accent/30 font-sans\",children:[/*#__PURE__*/_jsx(Sparkles,{className:\"w-3 h-3 mr-1\"}),\"AI Workspace\"]}),/*#__PURE__*/_jsx(Avatar,{className:\"w-9 h-9 border-2 border-primary/20\",children:/*#__PURE__*/_jsx(AvatarFallback,{className:\"bg-gradient-primary text-primary-foreground\",children:/*#__PURE__*/_jsx(User,{className:\"w-5 h-5\"})})})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(isWorkspaceActive?'flex gap-6':'flex justify-center items-center min-h-[calc(100vh-8rem)]',\" px-4 sm:px-6 lg:px-8 py-8 relative z-10 max-w-7xl mx-auto\"),children:[!isWorkspaceActive&&/*#__PURE__*/_jsxs(\"div\",{className:\"w-full max-w-3xl space-y-8 animate-slide-up\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 rounded-2xl bg-gradient-primary flex items-center justify-center shadow-xl\",children:/*#__PURE__*/_jsx(Clapperboard,{className:\"w-10 h-10 text-primary-foreground\"})})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-5xl font-display font-bold text-foreground\",children:\"Your Personal Director\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-muted-foreground leading-relaxed font-sans max-w-2xl mx-auto\",children:\"I'll help you create viral content by telling you what to film, where to cut (pauses, filler words), and which trending audio to use.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(Card,{className:\"border-border/50 shadow-lg bg-card/95 backdrop-blur-sm hover:shadow-xl transition-all cursor-pointer group\",onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-6 pb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-all\",children:/*#__PURE__*/_jsx(Upload,{className:\"w-6 h-6 text-primary\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 text-left\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-foreground font-display mb-1\",children:\"Upload Footage\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground\",children:\"Get AI editing suggestions\"})]})]})})}),/*#__PURE__*/_jsx(Card,{className:\"border-border/50 shadow-lg bg-card/95 backdrop-blur-sm hover:shadow-xl transition-all cursor-pointer group\",onClick:()=>{var _textareaRef$current2;setIsWorkspaceActive(true);(_textareaRef$current2=textareaRef.current)===null||_textareaRef$current2===void 0?void 0:_textareaRef$current2.focus();},children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-6 pb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 rounded-xl bg-secondary/10 flex items-center justify-center group-hover:bg-secondary/20 transition-all\",children:/*#__PURE__*/_jsx(Film,{className:\"w-6 h-6 text-secondary\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 text-left\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-foreground font-display mb-1\",children:\"Get Content Ideas\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground\",children:\"Ask what to create\"})]})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground font-semibold\",children:\"Try asking:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:quickPrompts.map((prompt,i)=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _textareaRef$current3;setInputValue(prompt.text);setIsWorkspaceActive(true);(_textareaRef$current3=textareaRef.current)===null||_textareaRef$current3===void 0?void 0:_textareaRef$current3.focus();},className:\"w-full text-left p-3 rounded-lg border border-border/50 bg-card/80 hover:bg-muted/50 transition-all text-sm text-foreground font-sans flex items-center gap-2\",children:[prompt.icon,/*#__PURE__*/_jsx(\"span\",{children:prompt.text})]},i))})]}),/*#__PURE__*/_jsx(Card,{className:\"border-border/50 shadow-xl bg-card/95 backdrop-blur-sm\",children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-4 pb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(Textarea,{ref:textareaRef,value:inputValue,onChange:e=>setInputValue(e.target.value),onKeyDown:handleKeyDown,placeholder:\"Describe your content idea or ask for advice...\",className:\"min-h-[60px] resize-none focus:ring-primary font-sans text-base\",disabled:isProcessing||isAnalyzing||isUploading}),/*#__PURE__*/_jsx(Button,{onClick:handleSendMessage,disabled:isProcessing||isAnalyzing||isUploading||!inputValue.trim(),className:\"bg-gradient-primary hover:shadow-glow self-end px-5 h-[60px] transition-all duration-300\",children:/*#__PURE__*/_jsx(Send,{className:\"w-5 h-5\"})})]})})}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"video/*\",onChange:handleFileSelect,className:\"hidden\"})]}),isWorkspaceActive&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 space-y-6 overflow-y-auto max-h-[calc(100vh-8rem)]\",children:[!uploadedVideo&&/*#__PURE__*/_jsx(Card,{className:\"border-border/50 shadow-xl bg-card/95 backdrop-blur-sm animate-slide-up\",children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-6\",children:/*#__PURE__*/_jsxs(\"div\",{onDragOver:handleDragOver,onDragLeave:handleDragLeave,onDrop:handleDrop,className:\"border-2 border-dashed rounded-xl p-8 transition-all duration-300 \".concat(isDragging?'border-primary bg-primary/5 scale-[1.01] shadow-glow':'border-border/50 hover:border-border hover:bg-muted/20'),children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"video/*\",onChange:handleFileSelect,className:\"hidden\"}),isUploading?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center gap-4\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"w-12 h-12 text-primary animate-spin\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center w-full max-w-xs\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold text-foreground mb-2\",children:\"Uploading video...\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-muted rounded-full h-2 overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"h-full bg-gradient-primary transition-all duration-300\",style:{width:\"\".concat(uploadProgress,\"%\")}})}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-muted-foreground mt-2\",children:[uploadProgress,\"%\"]})]})]}):/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _fileInputRef$current2;return(_fileInputRef$current2=fileInputRef.current)===null||_fileInputRef$current2===void 0?void 0:_fileInputRef$current2.click();},className:\"w-full flex flex-col items-center justify-center gap-3 group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 rounded-xl bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-all duration-300 group-hover:scale-110\",children:/*#__PURE__*/_jsx(Upload,{className:\"w-8 h-8 text-primary\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-base font-semibold text-foreground font-sans\",children:\"Drop your video here or click to browse\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground mt-1 font-sans\",children:\"Supports MP4, MOV, AVI \\u2022 Max 100MB\"})]})]})]})})}),uploadedVideo&&/*#__PURE__*/_jsx(Card,{className:\"border-border/50 shadow-xl bg-card/95 backdrop-blur-sm animate-slide-up\",children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-20 h-20 rounded-lg bg-muted flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(Video,{className:\"w-10 h-10 text-muted-foreground\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 min-w-0\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-foreground truncate\",children:uploadedVideo.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-muted-foreground\",children:[uploadedVideo.size,\" MB\"]}),currentSuggestions.length>0&&/*#__PURE__*/_jsxs(Badge,{className:\"mt-2 bg-primary/10 text-primary border-primary/20\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-3 h-3 mr-1\"}),currentSuggestions.length,\" suggestions generated\"]})]}),/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"ghost\",onClick:removeVideo,className:\"text-destructive hover:text-destructive hover:bg-destructive/10\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4\"})})]})})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4 animate-slide-up\",style:{animationDelay:'0.1s'},children:[messages.map((message,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 \".concat(message.role==='user'?'justify-end':'justify-start'),children:[(message.role==='assistant'||message.role==='system')&&/*#__PURE__*/_jsx(Avatar,{className:\"w-10 h-10 border-2 border-primary/20 flex-shrink-0\",children:/*#__PURE__*/_jsx(AvatarFallback,{className:\"bg-gradient-primary text-primary-foreground\",children:message.role==='system'?/*#__PURE__*/_jsx(AlertCircle,{className:\"w-5 h-5\"}):/*#__PURE__*/_jsx(Sparkles,{className:\"w-5 h-5\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 max-w-3xl \".concat(message.role==='user'?'flex flex-col items-end':''),children:[/*#__PURE__*/_jsx(Card,{className:\"\".concat(message.role==='user'?'bg-gradient-primary text-primary-foreground border-0 shadow-md':message.role==='system'?'bg-accent/10 border-accent/30 shadow-md':'bg-card/95 backdrop-blur-sm border-border/50 shadow-lg',\" card-lift\"),children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-4 pb-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-sm max-w-none \".concat(message.role==='user'?'prose-invert':''),children:message.content.split('\\n').map((line,i)=>/*#__PURE__*/_jsx(\"p\",{className:\"mb-2 last:mb-0 whitespace-pre-wrap font-sans leading-relaxed\",children:line},i))})})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-muted-foreground mt-1.5 font-sans\",children:message.timestamp.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})})]}),message.role==='user'&&/*#__PURE__*/_jsx(Avatar,{className:\"w-10 h-10 border-2 border-primary/20 flex-shrink-0\",children:/*#__PURE__*/_jsx(AvatarFallback,{className:\"bg-muted text-muted-foreground\",children:/*#__PURE__*/_jsx(User,{className:\"w-5 h-5\"})})})]},index)),(isProcessing||isAnalyzing)&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 justify-start animate-bounce-in\",children:[/*#__PURE__*/_jsx(Avatar,{className:\"w-10 h-10 border-2 border-primary/20\",children:/*#__PURE__*/_jsx(AvatarFallback,{className:\"bg-gradient-primary text-primary-foreground\",children:/*#__PURE__*/_jsx(Sparkles,{className:\"w-5 h-5\"})})}),/*#__PURE__*/_jsx(Card,{className:\"bg-card/95 backdrop-blur-sm border-border/50 shadow-lg\",children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-4 pb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full bg-primary animate-bounce\",style:{animationDelay:'0s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full bg-primary animate-bounce\",style:{animationDelay:'0.2s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full bg-primary animate-bounce\",style:{animationDelay:'0.4s'}})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-muted-foreground font-sans\",children:isAnalyzing?'Analyzing your video...':'Thinking...'})]})})})]}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),directorMode&&shotList&&shotList.length>0&&/*#__PURE__*/_jsx(Card,{className:\"border-primary/30 shadow-xl bg-primary/5 backdrop-blur-sm animate-slide-up mb-6\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center\",children:/*#__PURE__*/_jsx(Film,{className:\"w-5 h-5 text-primary\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-foreground\",children:\"Shot List\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-muted-foreground\",children:[shotList.filter(s=>s.uploaded).length,\" / \",shotList.length,\" segments recorded\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:shotList.map((shot,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-lg border-2 transition-all \".concat(shot.uploaded?'bg-green-50 border-green-200 dark:bg-green-950/20 dark:border-green-800':'bg-card border-border hover:border-primary/50'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[shot.uploaded?/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5 text-green-600\"}):/*#__PURE__*/_jsx(Clock,{className:\"w-5 h-5 text-muted-foreground\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-foreground capitalize\",children:shot.segment_name.replace('_',' ')}),/*#__PURE__*/_jsxs(Badge,{variant:\"outline\",className:\"text-xs\",children:[shot.duration,\"s\"]})]}),shot.required&&!shot.uploaded&&/*#__PURE__*/_jsx(Badge,{variant:\"destructive\",className:\"text-xs\",children:\"Required\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-muted-foreground mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Script:\"}),\" \",shot.script]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-muted-foreground\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Visual Guide:\"}),\" \",shot.visual_guide]})]},index))}),matchedFormat&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 p-4 rounded-lg bg-accent/10 border border-accent/30\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold text-foreground mb-1\",children:\"\\uD83D\\uDCCA Matched Format\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-muted-foreground\",children:[/*#__PURE__*/_jsx(\"strong\",{children:matchedFormat.name}),\" - \",matchedFormat.description]})]})]})}),/*#__PURE__*/_jsx(Card,{className:\"border-border/50 shadow-xl bg-card/95 backdrop-blur-sm sticky bottom-4 animate-slide-up\",style:{animationDelay:'0.2s'},children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-6\",children:[messages.length<=2&&!uploadedVideo&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground mb-3 font-sans font-medium\",children:\"Quick prompts:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:quickPrompts.map((prompt,i)=>/*#__PURE__*/_jsxs(Button,{variant:\"outline\",size:\"sm\",onClick:()=>handleQuickPrompt(prompt.text),className:\"\".concat(prompt.color,\" hover:scale-105 transition-all duration-300 font-sans\"),children:[prompt.icon,/*#__PURE__*/_jsx(\"span\",{className:\"ml-1.5\",children:prompt.text})]},i))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(Textarea,{ref:textareaRef,value:inputValue,onChange:e=>setInputValue(e.target.value),onKeyDown:handleKeyDown,placeholder:uploadedVideo&&currentSuggestions.length===0?\"Describe your content goals... (e.g., 'I'm building a language app for college students, targeting TikTok')\":\"Ask me anything about your content...\",className:\"min-h-[80px] resize-none focus:ring-primary font-sans text-base\",disabled:isProcessing||isAnalyzing||isUploading}),/*#__PURE__*/_jsx(Button,{onClick:handleSendMessage,disabled:isProcessing||isAnalyzing||isUploading||!inputValue.trim(),className:\"bg-gradient-primary hover:shadow-glow self-end px-5 h-[80px] transition-all duration-300\",children:/*#__PURE__*/_jsx(Send,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-muted-foreground mt-2 font-sans\",children:uploadedVideo&&currentSuggestions.length===0?/*#__PURE__*/_jsxs(\"span\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Sparkles,{className:\"w-3 h-3\"}),\"Describe your goals and press Enter to analyze your video with AI\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"kbd\",{className:\"px-1.5 py-0.5 rounded bg-muted text-muted-foreground text-xs\",children:\"Enter\"}),\" to send,\",/*#__PURE__*/_jsx(\"kbd\",{className:\"px-1.5 py-0.5 rounded bg-muted text-muted-foreground text-xs ml-1\",children:\"Shift + Enter\"}),\" for new line\"]})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-[45%] space-y-6 sticky top-24 h-[calc(100vh-8rem)] overflow-y-auto\",children:[uploadedVideo&&/*#__PURE__*/_jsxs(\"div\",{className:\"animate-slide-up\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-foreground font-display flex items-center gap-2 mb-3\",children:[/*#__PURE__*/_jsx(Scissors,{className:\"w-5 h-5 text-primary\"}),\"Video Editor Timeline\"]}),/*#__PURE__*/_jsx(VideoTimeline,{videoUrl:uploadedVideo.url,timestampSuggestions:currentSuggestions.filter(s=>s.type==='timestamp')})]}),currentSuggestions.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 animate-slide-up\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-foreground font-display flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Wand2,{className:\"w-5 h-5 text-primary\"}),\"Director's Suggestions\"]}),currentSuggestions.map((suggestion,idx)=>/*#__PURE__*/_jsx(Card,{className:\"border-border/50 shadow-md bg-card/95 backdrop-blur-sm card-lift \".concat(suggestion.status==='accepted'?'border-green-500/50 bg-green-50/10':suggestion.status==='rejected'?'opacity-50':''),children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-4 pb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-3xl flex-shrink-0\",children:getSuggestionIcon(suggestion.type)}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between gap-2 mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-foreground font-display\",children:suggestion.title}),/*#__PURE__*/_jsx(Badge,{variant:\"secondary\",className:\"mt-1 text-xs\",children:suggestion.type})]}),suggestion.status==='pending'&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1\",children:[/*#__PURE__*/_jsx(Button,{size:\"sm\",onClick:()=>handleSuggestionAccept(suggestion),className:\"bg-green-500 hover:bg-green-600 text-white\",children:/*#__PURE__*/_jsx(ThumbsUp,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"outline\",onClick:()=>handleSuggestionReject(suggestion),className:\"border-destructive/50 text-destructive hover:bg-destructive/10\",children:/*#__PURE__*/_jsx(ThumbsDown,{className:\"w-4 h-4\"})})]}),suggestion.status==='accepted'&&/*#__PURE__*/_jsxs(Badge,{className:\"bg-green-500/10 text-green-700 border-green-500/30\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-3 h-3 mr-1\"}),\"Accepted\"]}),suggestion.status==='rejected'&&/*#__PURE__*/_jsxs(Badge,{variant:\"secondary\",className:\"bg-muted\",children:[/*#__PURE__*/_jsx(XCircle,{className:\"w-3 h-3 mr-1\"}),\"Rejected\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground mb-2 font-sans\",children:suggestion.description}),suggestion.type==='example_video'&&suggestion.video_url&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 p-3 bg-primary/5 border border-primary/20 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(Badge,{className:\"bg-primary/10 text-primary border-primary/30 text-xs\",children:\"Example Video\"}),suggestion.metrics&&/*#__PURE__*/_jsx(Badge,{variant:\"outline\",className:\"text-xs\",children:suggestion.metrics})]}),suggestion.creator&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm font-semibold text-foreground mb-1\",children:[\"By: \",suggestion.creator]}),/*#__PURE__*/_jsx(\"a\",{href:suggestion.video_url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-sm text-primary hover:text-primary/80 underline break-all\",children:\"\\uD83D\\uDD17 Watch on TikTok\"})]}),(suggestion.type==='audio'||suggestion.type==='bgm')&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 p-3 bg-purple-50/50 dark:bg-purple-950/20 border border-purple-200/50 dark:border-purple-800/50 rounded-lg\",children:/*#__PURE__*/_jsx(Badge,{className:\"bg-purple-100 text-purple-700 border-purple-300 text-xs mb-2\",children:\"\\uD83C\\uDFB5 Trending Audio\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-muted/30 rounded-lg p-3 mb-2\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-foreground font-sans leading-relaxed\",children:suggestion.content})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-muted-foreground italic font-sans\",children:[\"\\uD83D\\uDCA1 \",suggestion.reasoning]}),/*#__PURE__*/_jsxs(Badge,{variant:\"outline\",className:\"text-xs\",children:[Math.round(suggestion.confidence_score*100),\"% confidence\"]})]})]})]})})},suggestion.id))]}),!uploadedVideo&&/*#__PURE__*/_jsx(Card,{className:\"border-border/50 shadow-lg bg-card/95 backdrop-blur-sm\",children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-12 pb-12 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 rounded-xl bg-muted flex items-center justify-center\",children:/*#__PURE__*/_jsx(Video,{className:\"w-8 h-8 text-muted-foreground\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-foreground font-display mb-2\",children:\"Upload Your Footage\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground\",children:\"Video editor will appear here once you upload\"})]})]})})})]})]})]})]});};","map":{"version":3,"names":["React","useState","useRef","useEffect","Button","Card","CardContent","Textarea","Badge","Avatar","AvatarFallback","Sparkles","Upload","X","Send","Video","CheckCircle","XCircle","TrendingUp","Wand2","Zap","Loader2","AlertCircle","ThumbsUp","ThumbsDown","Clock","Scissors","User","Film","Clapperboard","toast","useNavigate","uploadVideoChunked","analyzeVideo","sendChatMessage","getChatHistory","handleSuggestionAction","createDirectorProject","sendDirectorMessage","uploadDirectorSegment","getDirectorProject","VideoTimeline","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","WorkspaceEnhanced","navigate","messages","setMessages","inputValue","setInputValue","uploadedVideo","setUploadedVideo","uploadProgress","setUploadProgress","isUploading","setIsUploading","isAnalyzing","setIsAnalyzing","isProcessing","setIsProcessing","isDragging","setIsDragging","currentSuggestions","setCurrentSuggestions","trendingFormat","setTrendingFormat","isWorkspaceActive","setIsWorkspaceActive","directorMode","setDirectorMode","directorProject","setDirectorProject","shotList","setShotList","matchedFormat","setMatchedFormat","fileInputRef","textareaRef","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","loadChatHistory","history","length","formattedMessages","map","msg","role","content","timestamp","Date","error","console","quickPrompts","icon","className","text","color","handleFileSelect","e","files","Array","from","target","handleVideoUpload","file","type","startsWith","result","progress","percentage","id","video_metadata","name","size","toFixed","url","URL","createObjectURL","success","description","systemMessage","concat","prev","message","handleDragOver","preventDefault","handleDragLeave","handleDrop","dataTransfer","removeVideo","handleAnalyzeVideo","trim","userMessage","loading","aiResponse","formatAnalysisResponse","aiMessage","suggestions","format","recommended_format","errorMessage","reasoning","format_reasoning","hashtags","trending_hashtags_used","response","structure","h","hashtag","join","handleSendMessage","userMessageText","toLowerCase","includes","startDirectorMode","handleDirectorMessage","initialMessage","matched_format","shot_list","project_id","handleSuggestionAccept","suggestion","s","_objectSpread","status","title","handleSuggestionReject","handleQuickPrompt","promptText","_textareaRef$current","focus","handleKeyDown","key","shiftKey","getSuggestionIcon","formatTimestamp","seconds","mins","Math","floor","secs","toString","padStart","children","style","animationDelay","onClick","_fileInputRef$current","click","_textareaRef$current2","prompt","i","_textareaRef$current3","ref","value","onChange","onKeyDown","placeholder","disabled","accept","onDragOver","onDragLeave","onDrop","width","_fileInputRef$current2","variant","index","split","line","toLocaleTimeString","hour","minute","filter","uploaded","shot","segment_name","replace","duration","required","script","visual_guide","videoUrl","timestampSuggestions","idx","video_url","metrics","creator","href","rel","round","confidence_score"],"sources":["/app/frontend/src/components/WorkspaceEnhanced.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { Button } from './ui/button';\nimport { Card, CardContent } from './ui/card';\nimport { Textarea } from './ui/textarea';\nimport { Badge } from './ui/badge';\nimport { Avatar, AvatarFallback } from './ui/avatar';\nimport { \n  Sparkles, Upload, X, Send, Video, CheckCircle, XCircle, \n  TrendingUp, Wand2, Zap, Loader2, AlertCircle, ThumbsUp, ThumbsDown,\n  Clock, Scissors, User, Film, Clapperboard\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport { useNavigate } from 'react-router-dom';\nimport {\n  uploadVideoChunked,\n  analyzeVideo,\n  sendChatMessage,\n  getChatHistory,\n  handleSuggestionAction,\n  createDirectorProject,\n  sendDirectorMessage,\n  uploadDirectorSegment,\n  getDirectorProject\n} from '../utils/api';\nimport { VideoTimeline } from './VideoTimeline';\n\nexport const WorkspaceEnhanced = () => {\n  const navigate = useNavigate();\n  const [messages, setMessages] = useState([]);\n  const [inputValue, setInputValue] = useState('');\n  const [uploadedVideo, setUploadedVideo] = useState(null);\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [isUploading, setIsUploading] = useState(false);\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [isDragging, setIsDragging] = useState(false);\n  const [currentSuggestions, setCurrentSuggestions] = useState([]);\n  const [trendingFormat, setTrendingFormat] = useState(null);\n  const [isWorkspaceActive, setIsWorkspaceActive] = useState(false);\n  \n  // Director mode state\n  const [directorMode, setDirectorMode] = useState(false);\n  const [directorProject, setDirectorProject] = useState(null);\n  const [shotList, setShotList] = useState([]);\n  const [matchedFormat, setMatchedFormat] = useState(null);\n  \n  const fileInputRef = useRef(null);\n  const textareaRef = useRef(null);\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Load chat history on mount\n  useEffect(() => {\n    loadChatHistory();\n  }, []);\n\n  const loadChatHistory = async () => {\n    try {\n      const history = await getChatHistory();\n      if (history.messages && history.messages.length > 0) {\n        const formattedMessages = history.messages.map(msg => ({\n          role: msg.role,\n          content: msg.content,\n          timestamp: new Date(msg.timestamp)\n        }));\n        setMessages(formattedMessages);\n      } else {\n        // Add welcome message if no history\n        setMessages([{\n          role: 'assistant',\n          content: 'ðŸŽ¬ Hey! I\\'m your AI Director powered by LangGraph!\\n\\n**Two modes available:**\\n\\nðŸŽ¥ **Director Mode** - I\\'ll guide you step-by-step to create viral videos:\\n  â€¢ Match you with proven viral formats (YC Demo, Cluely Launch, etc.)\\n  â€¢ Create custom shot lists and scripts\\n  â€¢ Guide you through recording each segment\\n  â€¢ Edit and optimize your final video\\n\\nJust say \"Start Director Mode\" to begin!\\n\\nðŸ“¹ **Quick Analysis** - Upload existing footage for instant AI analysis and suggestions.\\n\\nWhat would you like to do?',\n          timestamp: new Date()\n        }]);\n      }\n    } catch (error) {\n      console.error('Error loading chat history:', error);\n      setMessages([{\n        role: 'assistant',\n        content: 'ðŸŽ¬ Hey! I\\'m your personal director. Upload footage or tell me your content idea, and I\\'ll help you create viral content!',\n        timestamp: new Date()\n      }]);\n    }\n  };\n\n  const quickPrompts = [\n    { icon: <Film className=\"w-4 h-4\" />, text: 'What content should I create?', color: 'bg-primary/10 text-primary border-primary/20' },\n    { icon: <Scissors className=\"w-4 h-4\" />, text: 'Help me edit my footage', color: 'bg-secondary/10 text-secondary border-secondary/20' },\n    { icon: <TrendingUp className=\"w-4 h-4\" />, text: 'What\\'s trending right now?', color: 'bg-accent/20 text-foreground border-accent/30' },\n  ];\n\n  const handleFileSelect = async (e) => {\n    const files = Array.from(e.target.files || []);\n    if (files.length > 0) {\n      await handleVideoUpload(files[0]);\n    }\n  };\n\n  const handleVideoUpload = async (file) => {\n    if (!file.type.startsWith('video/')) {\n      toast.error('Please upload a video file');\n      return;\n    }\n\n    setIsUploading(true);\n    setUploadProgress(0);\n\n    try {\n      const result = await uploadVideoChunked(file, (progress) => {\n        setUploadProgress(progress.percentage);\n      });\n\n      setUploadedVideo({\n        id: result.video_metadata.id,\n        name: file.name,\n        size: (file.size / 1024 / 1024).toFixed(2),\n        url: URL.createObjectURL(file)\n      });\n\n      toast.success('Video uploaded! ðŸŽ‰', {\n        description: 'Ready for AI analysis'\n      });\n\n      // Activate workspace\n      if (!isWorkspaceActive) {\n        setIsWorkspaceActive(true);\n      }\n\n      // Add system message\n      const systemMessage = {\n        role: 'system',\n        content: `ðŸ“¹ Video \"${file.name}\" (${(file.size / 1024 / 1024).toFixed(2)} MB) uploaded successfully! Ready to analyze.`,\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, systemMessage]);\n\n    } catch (error) {\n      console.error('Upload error:', error);\n      toast.error('Upload failed', {\n        description: error.message || 'Please try again'\n      });\n    } finally {\n      setIsUploading(false);\n      setUploadProgress(0);\n    }\n  };\n\n  const handleDragOver = (e) => {\n    e.preventDefault();\n    setIsDragging(true);\n  };\n\n  const handleDragLeave = (e) => {\n    e.preventDefault();\n    setIsDragging(false);\n  };\n\n  const handleDrop = (e) => {\n    e.preventDefault();\n    setIsDragging(false);\n    const files = Array.from(e.dataTransfer.files);\n    if (files.length > 0 && files[0].type.startsWith('video/')) {\n      handleVideoUpload(files[0]);\n    } else {\n      toast.error('Please drop a video file');\n    }\n  };\n\n  const removeVideo = () => {\n    setUploadedVideo(null);\n    setCurrentSuggestions([]);\n    setTrendingFormat(null);\n    toast.success('Video removed');\n  };\n\n  const handleAnalyzeVideo = async () => {\n    if (!uploadedVideo) {\n      toast.error('Please upload a video first');\n      return;\n    }\n\n    if (!inputValue.trim()) {\n      toast.error('Please describe your content goals');\n      return;\n    }\n\n    setIsAnalyzing(true);\n    setIsProcessing(true);\n\n    // Add user message\n    const userMessage = {\n      role: 'user',\n      content: inputValue.trim(),\n      timestamp: new Date()\n    };\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n\n    try {\n      toast.loading('Analyzing your video...', { id: 'analysis' });\n\n      const result = await analyzeVideo(\n        uploadedVideo.id,\n        inputValue.trim(),\n        null\n      );\n\n      toast.success('Analysis complete! ðŸŽ¯', { id: 'analysis' });\n\n      // Format AI response\n      const aiResponse = formatAnalysisResponse(result);\n      const aiMessage = {\n        role: 'assistant',\n        content: aiResponse,\n        timestamp: new Date(),\n        suggestions: result.suggestions,\n        format: result.recommended_format\n      };\n      setMessages(prev => [...prev, aiMessage]);\n\n      // Store suggestions\n      setCurrentSuggestions(result.suggestions || []);\n      setTrendingFormat(result.recommended_format);\n\n    } catch (error) {\n      console.error('Analysis error:', error);\n      toast.error('Analysis failed', { id: 'analysis', description: error.message });\n      \n      const errorMessage = {\n        role: 'assistant',\n        content: 'âŒ Sorry, I encountered an error analyzing your video. Please try again or contact support if the issue persists.',\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, errorMessage]);\n    } finally {\n      setIsAnalyzing(false);\n      setIsProcessing(false);\n    }\n  };\n\n  const formatAnalysisResponse = (result) => {\n    const format = result.recommended_format;\n    const reasoning = result.format_reasoning;\n    const suggestions = result.suggestions || [];\n    const hashtags = result.trending_hashtags_used || [];\n\n    let response = `ðŸŽ¬ **Video Analysis Complete!**\\n\\n`;\n    response += `ðŸ“Š **Recommended Format: \"${format?.name || 'Custom'}\"**\\n`;\n    response += `${reasoning}\\n\\n`;\n    response += `**Format Structure:** ${format?.structure || 'N/A'}\\n\\n`;\n    response += `ðŸ’¡ **AI Suggestions (${suggestions.length}):**\\n`;\n    response += `I've generated ${suggestions.length} actionable suggestions below. Review each one and accept the ones that resonate with your vision!\\n\\n`;\n    \n    if (hashtags.length > 0) {\n      response += `ðŸ”¥ **Trending Hashtags:**\\n`;\n      response += hashtags.map(h => `#${h.hashtag}`).join(' ') + '\\n\\n';\n    }\n\n    response += `ðŸ‘‡ Scroll down to see all suggestions with accept/reject buttons.`;\n\n    return response;\n  };\n\n  const handleSendMessage = async () => {\n    if (!inputValue.trim()) {\n      return;\n    }\n\n    // Activate workspace on first interaction\n    if (!isWorkspaceActive) {\n      setIsWorkspaceActive(true);\n    }\n\n    const userMessageText = inputValue.trim();\n    \n    // Check if user wants to start Director mode\n    if (userMessageText.toLowerCase().includes('director mode') || \n        userMessageText.toLowerCase().includes('start director')) {\n      await startDirectorMode(userMessageText);\n      return;\n    }\n\n    // If in Director mode, route to Director\n    if (directorMode && directorProject) {\n      await handleDirectorMessage(userMessageText);\n      return;\n    }\n\n    // If video is uploaded but not analyzed yet, trigger analysis\n    if (uploadedVideo && currentSuggestions.length === 0) {\n      handleAnalyzeVideo();\n      return;\n    }\n\n    setIsProcessing(true);\n\n    const userMessage = {\n      role: 'user',\n      content: userMessageText,\n      timestamp: new Date()\n    };\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n\n    try {\n      const result = await sendChatMessage(\n        userMessage.content,\n        uploadedVideo?.id\n      );\n\n      const aiMessage = {\n        role: 'assistant',\n        content: result.response,\n        timestamp: new Date(result.timestamp)\n      };\n      setMessages(prev => [...prev, aiMessage]);\n\n    } catch (error) {\n      console.error('Chat error:', error);\n      toast.error('Failed to send message');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // Start Director Mode\n  const startDirectorMode = async (initialMessage) => {\n    setIsProcessing(true);\n    setInputValue('');\n\n    const userMessage = {\n      role: 'user',\n      content: initialMessage,\n      timestamp: new Date()\n    };\n    setMessages(prev => [...prev, userMessage]);\n\n    try {\n      // Ask user for their goal\n      const aiMessage = {\n        role: 'assistant',\n        content: 'ðŸŽ¬ **Director Mode Activated!**\\n\\nLet\\'s create something viral together! Tell me:\\n\\n1. What do you want to create? (e.g., \"A demo video for my language learning app\")\\n2. Who is your target audience? (e.g., \"College students on TikTok\")\\n3. What platform? (TikTok, Instagram, YouTube)\\n\\nDescribe your video idea and I\\'ll match you with the perfect viral format!',\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, aiMessage]);\n      setDirectorMode('awaiting_goal');\n      \n    } catch (error) {\n      console.error('Error starting Director mode:', error);\n      toast.error('Failed to start Director mode');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  // Handle Director message\n  const handleDirectorMessage = async (message) => {\n    setIsProcessing(true);\n    setInputValue('');\n\n    const userMessage = {\n      role: 'user',\n      content: message,\n      timestamp: new Date()\n    };\n    setMessages(prev => [...prev, userMessage]);\n\n    try {\n      let result;\n\n      // If no project yet, create one\n      if (!directorProject) {\n        result = await createDirectorProject(message, 'general', 'TikTok');\n        setDirectorProject(result);\n        setDirectorMode(true);\n        \n        // Update state from result\n        if (result.matched_format) {\n          setMatchedFormat(result.matched_format);\n        }\n        if (result.shot_list) {\n          setShotList(result.shot_list);\n        }\n      } else {\n        // Continue existing project\n        result = await sendDirectorMessage(directorProject.project_id, message);\n        \n        // Update state from result\n        if (result.shot_list) {\n          setShotList(result.shot_list);\n        }\n        if (result.matched_format) {\n          setMatchedFormat(result.matched_format);\n        }\n      }\n\n      const aiMessage = {\n        role: 'assistant',\n        content: result.message,\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, aiMessage]);\n\n    } catch (error) {\n      console.error('Director error:', error);\n      toast.error('Failed to process Director message');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleSuggestionAccept = async (suggestion) => {\n    try {\n      await handleSuggestionAction(suggestion.id, 'accept');\n      \n      // Update local state\n      setCurrentSuggestions(prev =>\n        prev.map(s => s.id === suggestion.id ? { ...s, status: 'accepted' } : s)\n      );\n\n      toast.success('Suggestion accepted! âœ…', {\n        description: suggestion.title\n      });\n    } catch (error) {\n      toast.error('Failed to accept suggestion');\n    }\n  };\n\n  const handleSuggestionReject = async (suggestion) => {\n    try {\n      await handleSuggestionAction(suggestion.id, 'reject');\n      \n      // Update local state\n      setCurrentSuggestions(prev =>\n        prev.map(s => s.id === suggestion.id ? { ...s, status: 'rejected' } : s)\n      );\n\n      toast.success('Suggestion rejected', {\n        description: 'Removed from your list'\n      });\n    } catch (error) {\n      toast.error('Failed to reject suggestion');\n    }\n  };\n\n  const handleQuickPrompt = (promptText) => {\n    setInputValue(promptText);\n    textareaRef.current?.focus();\n  };\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const getSuggestionIcon = (type) => {\n    switch (type) {\n      case 'script': return 'ðŸ“';\n      case 'text_overlay': return 'ðŸ’¬';\n      case 'shot': return 'ðŸŽ¥';\n      case 'timestamp': return 'â±ï¸';\n      case 'format': return 'ðŸŽ¬';\n      case 'audio': return 'ðŸŽµ';\n      case 'bgm': return 'ðŸŽ§';\n      case 'example_video': return 'ðŸŒŸ';\n      default: return 'âœ¨';\n    }\n  };\n\n  const formatTimestamp = (seconds) => {\n    if (!seconds && seconds !== 0) return '00:00';\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-sky relative overflow-hidden gradient-bg-dynamic\">\n      {/* Dynamic gradient orbs */}\n      <div className=\"gradient-orb-1\"></div>\n      <div className=\"gradient-orb-2\"></div>\n      <div className=\"gradient-orb-3\"></div>\n      \n      {/* Floating decorative stickers */}\n      <div className=\"absolute inset-0 pointer-events-none overflow-hidden z-10\">\n        <div className=\"floating-sticker top-20 left-[8%] text-5xl animate-float\" style={{ animationDelay: '0s' }}>âœ¨</div>\n        <div className=\"floating-sticker top-32 right-[12%] text-4xl animate-float\" style={{ animationDelay: '1.5s' }}>ðŸŽ¬</div>\n        <div className=\"floating-sticker bottom-32 left-[15%] text-4xl animate-float\" style={{ animationDelay: '3s' }}>ðŸš€</div>\n        <div className=\"floating-sticker top-[45%] right-[20%] text-3xl animate-float\" style={{ animationDelay: '2s' }}>ðŸ’¡</div>\n        <div className=\"floating-sticker bottom-24 right-[8%] text-4xl animate-float\" style={{ animationDelay: '2.5s' }}>âš¡</div>\n        <div className=\"floating-sticker top-[60%] left-[5%] text-3xl animate-float\" style={{ animationDelay: '1s' }}>ðŸŽ¯</div>\n      </div>\n\n      {/* Navigation */}\n      <nav className=\"border-b border-border/50 bg-background/80 backdrop-blur-md sticky top-0 z-50\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <button onClick={() => navigate('/')} className=\"flex items-center gap-2 hover:opacity-80 transition-opacity\">\n              <span className=\"text-5xl font-logo font-bold text-foreground\">Trendle</span>\n            </button>\n            <div className=\"flex items-center gap-4\">\n              {directorMode ? (\n                <Badge className=\"hidden sm:flex bg-primary/20 text-primary border-primary/30 hover:bg-primary/30 font-sans animate-pulse\">\n                  <Film className=\"w-3 h-3 mr-1\" />\n                  Director Mode\n                </Badge>\n              ) : (\n                <Badge className=\"hidden sm:flex bg-accent/20 text-foreground border-accent/30 hover:bg-accent/30 font-sans\">\n                  <Sparkles className=\"w-3 h-3 mr-1\" />\n                  AI Workspace\n                </Badge>\n              )}\n              <Avatar className=\"w-9 h-9 border-2 border-primary/20\">\n                <AvatarFallback className=\"bg-gradient-primary text-primary-foreground\">\n                  <User className=\"w-5 h-5\" />\n                </AvatarFallback>\n              </Avatar>\n            </div>\n          </div>\n        </div>\n      </nav>\n\n      {/* Main Content */}\n      <div className={`${isWorkspaceActive ? 'flex gap-6' : 'flex justify-center items-center min-h-[calc(100vh-8rem)]'} px-4 sm:px-6 lg:px-8 py-8 relative z-10 max-w-7xl mx-auto`}>\n        \n        {/* ChatGPT-style Initial View */}\n        {!isWorkspaceActive && (\n          <div className=\"w-full max-w-3xl space-y-8 animate-slide-up\">\n            {/* Hero Section */}\n            <div className=\"text-center space-y-4\">\n              <div className=\"flex justify-center mb-6\">\n                <div className=\"w-20 h-20 rounded-2xl bg-gradient-primary flex items-center justify-center shadow-xl\">\n                  <Clapperboard className=\"w-10 h-10 text-primary-foreground\" />\n                </div>\n              </div>\n              <h1 className=\"text-5xl font-display font-bold text-foreground\">\n                Your Personal Director\n              </h1>\n              <p className=\"text-xl text-muted-foreground leading-relaxed font-sans max-w-2xl mx-auto\">\n                I'll help you create viral content by telling you what to film, where to cut (pauses, filler words), and which trending audio to use.\n              </p>\n            </div>\n\n            {/* Quick Actions */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <Card className=\"border-border/50 shadow-lg bg-card/95 backdrop-blur-sm hover:shadow-xl transition-all cursor-pointer group\"\n                    onClick={() => fileInputRef.current?.click()}>\n                <CardContent className=\"pt-6 pb-6\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-all\">\n                      <Upload className=\"w-6 h-6 text-primary\" />\n                    </div>\n                    <div className=\"flex-1 text-left\">\n                      <h3 className=\"font-semibold text-foreground font-display mb-1\">Upload Footage</h3>\n                      <p className=\"text-sm text-muted-foreground\">Get AI editing suggestions</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"border-border/50 shadow-lg bg-card/95 backdrop-blur-sm hover:shadow-xl transition-all cursor-pointer group\"\n                    onClick={() => { setIsWorkspaceActive(true); textareaRef.current?.focus(); }}>\n                <CardContent className=\"pt-6 pb-6\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-12 h-12 rounded-xl bg-secondary/10 flex items-center justify-center group-hover:bg-secondary/20 transition-all\">\n                      <Film className=\"w-6 h-6 text-secondary\" />\n                    </div>\n                    <div className=\"flex-1 text-left\">\n                      <h3 className=\"font-semibold text-foreground font-display mb-1\">Get Content Ideas</h3>\n                      <p className=\"text-sm text-muted-foreground\">Ask what to create</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Examples */}\n            <div className=\"space-y-3\">\n              <p className=\"text-sm text-muted-foreground font-semibold\">Try asking:</p>\n              <div className=\"space-y-2\">\n                {quickPrompts.map((prompt, i) => (\n                  <button\n                    key={i}\n                    onClick={() => { setInputValue(prompt.text); setIsWorkspaceActive(true); textareaRef.current?.focus(); }}\n                    className=\"w-full text-left p-3 rounded-lg border border-border/50 bg-card/80 hover:bg-muted/50 transition-all text-sm text-foreground font-sans flex items-center gap-2\"\n                  >\n                    {prompt.icon}\n                    <span>{prompt.text}</span>\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {/* Input at bottom */}\n            <Card className=\"border-border/50 shadow-xl bg-card/95 backdrop-blur-sm\">\n              <CardContent className=\"pt-4 pb-4\">\n                <div className=\"flex gap-2\">\n                  <Textarea\n                    ref={textareaRef}\n                    value={inputValue}\n                    onChange={(e) => setInputValue(e.target.value)}\n                    onKeyDown={handleKeyDown}\n                    placeholder=\"Describe your content idea or ask for advice...\"\n                    className=\"min-h-[60px] resize-none focus:ring-primary font-sans text-base\"\n                    disabled={isProcessing || isAnalyzing || isUploading}\n                  />\n                  <Button\n                    onClick={handleSendMessage}\n                    disabled={isProcessing || isAnalyzing || isUploading || !inputValue.trim()}\n                    className=\"bg-gradient-primary hover:shadow-glow self-end px-5 h-[60px] transition-all duration-300\"\n                  >\n                    <Send className=\"w-5 h-5\" />\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Hidden file input */}\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept=\"video/*\"\n              onChange={handleFileSelect}\n              className=\"hidden\"\n            />\n          </div>\n        )}\n\n        {/* Split Screen View - Active Workspace */}\n        {isWorkspaceActive && (\n          <>\n            {/* Left Side - Chat */}\n            <div className=\"flex-1 space-y-6 overflow-y-auto max-h-[calc(100vh-8rem)]\">\n\n              {/* Video Upload Area */}\n              {!uploadedVideo && (\n            <Card className=\"border-border/50 shadow-xl bg-card/95 backdrop-blur-sm animate-slide-up\">\n              <CardContent className=\"pt-6\">\n                <div\n                  onDragOver={handleDragOver}\n                  onDragLeave={handleDragLeave}\n                  onDrop={handleDrop}\n                  className={`border-2 border-dashed rounded-xl p-8 transition-all duration-300 ${\n                    isDragging \n                      ? 'border-primary bg-primary/5 scale-[1.01] shadow-glow' \n                      : 'border-border/50 hover:border-border hover:bg-muted/20'\n                  }`}\n                >\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\"video/*\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  \n                  {isUploading ? (\n                    <div className=\"flex flex-col items-center justify-center gap-4\">\n                      <Loader2 className=\"w-12 h-12 text-primary animate-spin\" />\n                      <div className=\"text-center w-full max-w-xs\">\n                        <p className=\"text-sm font-semibold text-foreground mb-2\">Uploading video...</p>\n                        <div className=\"w-full bg-muted rounded-full h-2 overflow-hidden\">\n                          <div \n                            className=\"h-full bg-gradient-primary transition-all duration-300\"\n                            style={{ width: `${uploadProgress}%` }}\n                          ></div>\n                        </div>\n                        <p className=\"text-xs text-muted-foreground mt-2\">{uploadProgress}%</p>\n                      </div>\n                    </div>\n                  ) : (\n                    <button\n                      onClick={() => fileInputRef.current?.click()}\n                      className=\"w-full flex flex-col items-center justify-center gap-3 group\"\n                    >\n                      <div className=\"w-16 h-16 rounded-xl bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-all duration-300 group-hover:scale-110\">\n                        <Upload className=\"w-8 h-8 text-primary\" />\n                      </div>\n                      <div className=\"text-center\">\n                        <p className=\"text-base font-semibold text-foreground font-sans\">Drop your video here or click to browse</p>\n                        <p className=\"text-sm text-muted-foreground mt-1 font-sans\">Supports MP4, MOV, AVI â€¢ Max 100MB</p>\n                      </div>\n                    </button>\n                  )}\n                </div>\n              </CardContent>\n                </Card>\n              )}\n\n              {/* Uploaded Video Display */}\n              {uploadedVideo && (\n            <Card className=\"border-border/50 shadow-xl bg-card/95 backdrop-blur-sm animate-slide-up\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-start gap-4\">\n                  <div className=\"w-20 h-20 rounded-lg bg-muted flex items-center justify-center flex-shrink-0\">\n                    <Video className=\"w-10 h-10 text-muted-foreground\" />\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-start justify-between gap-2\">\n                      <div>\n                        <p className=\"font-semibold text-foreground truncate\">{uploadedVideo.name}</p>\n                        <p className=\"text-sm text-muted-foreground\">{uploadedVideo.size} MB</p>\n                        {currentSuggestions.length > 0 && (\n                          <Badge className=\"mt-2 bg-primary/10 text-primary border-primary/20\">\n                            <CheckCircle className=\"w-3 h-3 mr-1\" />\n                            {currentSuggestions.length} suggestions generated\n                          </Badge>\n                        )}\n                      </div>\n                      <Button\n                        size=\"sm\"\n                        variant=\"ghost\"\n                        onClick={removeVideo}\n                        className=\"text-destructive hover:text-destructive hover:bg-destructive/10\"\n                      >\n                        <X className=\"w-4 h-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n                </Card>\n              )}\n\n              {/* Chat Messages */}\n              <div className=\"space-y-4 animate-slide-up\" style={{ animationDelay: '0.1s' }}>\n            {messages.map((message, index) => (\n              <div key={index} className={`flex gap-3 ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}>\n                {(message.role === 'assistant' || message.role === 'system') && (\n                  <Avatar className=\"w-10 h-10 border-2 border-primary/20 flex-shrink-0\">\n                    <AvatarFallback className=\"bg-gradient-primary text-primary-foreground\">\n                      {message.role === 'system' ? <AlertCircle className=\"w-5 h-5\" /> : <Sparkles className=\"w-5 h-5\" />}\n                    </AvatarFallback>\n                  </Avatar>\n                )}\n                \n                <div className={`flex-1 max-w-3xl ${message.role === 'user' ? 'flex flex-col items-end' : ''}`}>\n                  <Card className={`${\n                    message.role === 'user' \n                      ? 'bg-gradient-primary text-primary-foreground border-0 shadow-md' \n                      : message.role === 'system'\n                      ? 'bg-accent/10 border-accent/30 shadow-md'\n                      : 'bg-card/95 backdrop-blur-sm border-border/50 shadow-lg'\n                  } card-lift`}>\n                    <CardContent className=\"pt-4 pb-4\">\n                      <div className={`prose prose-sm max-w-none ${message.role === 'user' ? 'prose-invert' : ''}`}>\n                        {message.content.split('\\n').map((line, i) => (\n                          <p key={i} className=\"mb-2 last:mb-0 whitespace-pre-wrap font-sans leading-relaxed\">{line}</p>\n                        ))}\n                      </div>\n                    </CardContent>\n                  </Card>\n                  <span className=\"text-xs text-muted-foreground mt-1.5 font-sans\">\n                    {message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                  </span>\n                </div>\n\n                {message.role === 'user' && (\n                  <Avatar className=\"w-10 h-10 border-2 border-primary/20 flex-shrink-0\">\n                    <AvatarFallback className=\"bg-muted text-muted-foreground\">\n                      <User className=\"w-5 h-5\" />\n                    </AvatarFallback>\n                  </Avatar>\n                )}\n              </div>\n            ))}\n\n            {/* Processing Indicator */}\n            {(isProcessing || isAnalyzing) && (\n              <div className=\"flex gap-3 justify-start animate-bounce-in\">\n                <Avatar className=\"w-10 h-10 border-2 border-primary/20\">\n                  <AvatarFallback className=\"bg-gradient-primary text-primary-foreground\">\n                    <Sparkles className=\"w-5 h-5\" />\n                  </AvatarFallback>\n                </Avatar>\n                <Card className=\"bg-card/95 backdrop-blur-sm border-border/50 shadow-lg\">\n                  <CardContent className=\"pt-4 pb-4\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"flex gap-1\">\n                        <div className=\"w-2 h-2 rounded-full bg-primary animate-bounce\" style={{ animationDelay: '0s' }}></div>\n                        <div className=\"w-2 h-2 rounded-full bg-primary animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\n                        <div className=\"w-2 h-2 rounded-full bg-primary animate-bounce\" style={{ animationDelay: '0.4s' }}></div>\n                      </div>\n                      <span className=\"text-sm text-muted-foreground font-sans\">\n                        {isAnalyzing ? 'Analyzing your video...' : 'Thinking...'}\n                      </span>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            )}\n            <div ref={messagesEndRef} />\n          </div>\n\n          {/* Director Mode - Shot List Display */}\n          {directorMode && shotList && shotList.length > 0 && (\n            <Card className=\"border-primary/30 shadow-xl bg-primary/5 backdrop-blur-sm animate-slide-up mb-6\">\n              <CardContent className=\"pt-6\">\n                <div className=\"flex items-center gap-3 mb-4\">\n                  <div className=\"w-10 h-10 rounded-full bg-primary/20 flex items-center justify-center\">\n                    <Film className=\"w-5 h-5 text-primary\" />\n                  </div>\n                  <div>\n                    <h3 className=\"text-lg font-semibold text-foreground\">Shot List</h3>\n                    <p className=\"text-sm text-muted-foreground\">\n                      {shotList.filter(s => s.uploaded).length} / {shotList.length} segments recorded\n                    </p>\n                  </div>\n                </div>\n                <div className=\"space-y-3\">\n                  {shotList.map((shot, index) => (\n                    <div \n                      key={index}\n                      className={`p-4 rounded-lg border-2 transition-all ${\n                        shot.uploaded \n                          ? 'bg-green-50 border-green-200 dark:bg-green-950/20 dark:border-green-800' \n                          : 'bg-card border-border hover:border-primary/50'\n                      }`}\n                    >\n                      <div className=\"flex items-start justify-between mb-2\">\n                        <div className=\"flex items-center gap-2\">\n                          {shot.uploaded ? (\n                            <CheckCircle className=\"w-5 h-5 text-green-600\" />\n                          ) : (\n                            <Clock className=\"w-5 h-5 text-muted-foreground\" />\n                          )}\n                          <h4 className=\"font-semibold text-foreground capitalize\">\n                            {shot.segment_name.replace('_', ' ')}\n                          </h4>\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            {shot.duration}s\n                          </Badge>\n                        </div>\n                        {shot.required && !shot.uploaded && (\n                          <Badge variant=\"destructive\" className=\"text-xs\">Required</Badge>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-muted-foreground mb-2\">\n                        <strong>Script:</strong> {shot.script}\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        <strong>Visual Guide:</strong> {shot.visual_guide}\n                      </p>\n                    </div>\n                  ))}\n                </div>\n                \n                {matchedFormat && (\n                  <div className=\"mt-4 p-4 rounded-lg bg-accent/10 border border-accent/30\">\n                    <p className=\"text-sm font-semibold text-foreground mb-1\">ðŸ“Š Matched Format</p>\n                    <p className=\"text-sm text-muted-foreground\">\n                      <strong>{matchedFormat.name}</strong> - {matchedFormat.description}\n                    </p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Input Area */}\n          <Card className=\"border-border/50 shadow-xl bg-card/95 backdrop-blur-sm sticky bottom-4 animate-slide-up\" style={{ animationDelay: '0.2s' }}>\n            <CardContent className=\"pt-6\">\n              {/* Quick Prompts */}\n              {messages.length <= 2 && !uploadedVideo && (\n                <div className=\"mb-4\">\n                  <p className=\"text-sm text-muted-foreground mb-3 font-sans font-medium\">Quick prompts:</p>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {quickPrompts.map((prompt, i) => (\n                      <Button\n                        key={i}\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => handleQuickPrompt(prompt.text)}\n                        className={`${prompt.color} hover:scale-105 transition-all duration-300 font-sans`}\n                      >\n                        {prompt.icon}\n                        <span className=\"ml-1.5\">{prompt.text}</span>\n                      </Button>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Text Input */}\n              <div className=\"flex gap-2\">\n                <Textarea\n                  ref={textareaRef}\n                  value={inputValue}\n                  onChange={(e) => setInputValue(e.target.value)}\n                  onKeyDown={handleKeyDown}\n                  placeholder={\n                    uploadedVideo && currentSuggestions.length === 0\n                      ? \"Describe your content goals... (e.g., 'I'm building a language app for college students, targeting TikTok')\"\n                      : \"Ask me anything about your content...\"\n                  }\n                  className=\"min-h-[80px] resize-none focus:ring-primary font-sans text-base\"\n                  disabled={isProcessing || isAnalyzing || isUploading}\n                />\n                <Button\n                  onClick={handleSendMessage}\n                  disabled={isProcessing || isAnalyzing || isUploading || !inputValue.trim()}\n                  className=\"bg-gradient-primary hover:shadow-glow self-end px-5 h-[80px] transition-all duration-300\"\n                >\n                  <Send className=\"w-5 h-5\" />\n                </Button>\n              </div>\n\n              <p className=\"text-xs text-muted-foreground mt-2 font-sans\">\n                {uploadedVideo && currentSuggestions.length === 0 ? (\n                  <span className=\"flex items-center gap-1\">\n                    <Sparkles className=\"w-3 h-3\" />\n                    Describe your goals and press Enter to analyze your video with AI\n                  </span>\n                ) : (\n                  <>\n                    <kbd className=\"px-1.5 py-0.5 rounded bg-muted text-muted-foreground text-xs\">Enter</kbd> to send, \n                    <kbd className=\"px-1.5 py-0.5 rounded bg-muted text-muted-foreground text-xs ml-1\">Shift + Enter</kbd> for new line\n                  </>\n                )}\n              </p>\n            </CardContent>\n          </Card>\n            </div>\n\n            {/* Right Side - Video Editor Panel */}\n            <div className=\"w-[45%] space-y-6 sticky top-24 h-[calc(100vh-8rem)] overflow-y-auto\">\n              {/* Video Timeline Editor */}\n              {uploadedVideo && (\n                <div className=\"animate-slide-up\">\n                  <h3 className=\"text-lg font-semibold text-foreground font-display flex items-center gap-2 mb-3\">\n                    <Scissors className=\"w-5 h-5 text-primary\" />\n                    Video Editor Timeline\n                  </h3>\n                  <VideoTimeline\n                    videoUrl={uploadedVideo.url}\n                    timestampSuggestions={currentSuggestions.filter(s => s.type === 'timestamp')}\n                  />\n                </div>\n              )}\n\n              {/* AI Suggestions Display */}\n              {currentSuggestions.length > 0 && (\n                <div className=\"space-y-3 animate-slide-up\">\n                  <h3 className=\"text-lg font-semibold text-foreground font-display flex items-center gap-2\">\n                    <Wand2 className=\"w-5 h-5 text-primary\" />\n                    Director's Suggestions\n                  </h3>\n                  {currentSuggestions.map((suggestion, idx) => (\n                    <Card \n                      key={suggestion.id} \n                      className={`border-border/50 shadow-md bg-card/95 backdrop-blur-sm card-lift ${\n                        suggestion.status === 'accepted' ? 'border-green-500/50 bg-green-50/10' :\n                        suggestion.status === 'rejected' ? 'opacity-50' : ''\n                      }`}\n                    >\n                      <CardContent className=\"pt-4 pb-4\">\n                        <div className=\"flex items-start gap-3\">\n                          <div className=\"text-3xl flex-shrink-0\">{getSuggestionIcon(suggestion.type)}</div>\n                          <div className=\"flex-1 min-w-0\">\n                            <div className=\"flex items-start justify-between gap-2 mb-2\">\n                              <div className=\"flex-1\">\n                                <h4 className=\"font-semibold text-foreground font-display\">{suggestion.title}</h4>\n                                <Badge variant=\"secondary\" className=\"mt-1 text-xs\">{suggestion.type}</Badge>\n                              </div>\n                              {suggestion.status === 'pending' && (\n                                <div className=\"flex gap-1\">\n                                  <Button\n                                    size=\"sm\"\n                                    onClick={() => handleSuggestionAccept(suggestion)}\n                                    className=\"bg-green-500 hover:bg-green-600 text-white\"\n                                  >\n                                    <ThumbsUp className=\"w-4 h-4\" />\n                                  </Button>\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"outline\"\n                                    onClick={() => handleSuggestionReject(suggestion)}\n                                    className=\"border-destructive/50 text-destructive hover:bg-destructive/10\"\n                                  >\n                                    <ThumbsDown className=\"w-4 h-4\" />\n                                  </Button>\n                                </div>\n                              )}\n                              {suggestion.status === 'accepted' && (\n                                <Badge className=\"bg-green-500/10 text-green-700 border-green-500/30\">\n                                  <CheckCircle className=\"w-3 h-3 mr-1\" />\n                                  Accepted\n                                </Badge>\n                              )}\n                              {suggestion.status === 'rejected' && (\n                                <Badge variant=\"secondary\" className=\"bg-muted\">\n                                  <XCircle className=\"w-3 h-3 mr-1\" />\n                                  Rejected\n                                </Badge>\n                              )}\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-2 font-sans\">{suggestion.description}</p>\n                            \n                            {/* Special display for example videos */}\n                            {suggestion.type === 'example_video' && suggestion.video_url && (\n                              <div className=\"mb-3 p-3 bg-primary/5 border border-primary/20 rounded-lg\">\n                                <div className=\"flex items-center gap-2 mb-2\">\n                                  <Badge className=\"bg-primary/10 text-primary border-primary/30 text-xs\">\n                                    Example Video\n                                  </Badge>\n                                  {suggestion.metrics && (\n                                    <Badge variant=\"outline\" className=\"text-xs\">\n                                      {suggestion.metrics}\n                                    </Badge>\n                                  )}\n                                </div>\n                                {suggestion.creator && (\n                                  <p className=\"text-sm font-semibold text-foreground mb-1\">\n                                    By: {suggestion.creator}\n                                  </p>\n                                )}\n                                <a\n                                  href={suggestion.video_url}\n                                  target=\"_blank\"\n                                  rel=\"noopener noreferrer\"\n                                  className=\"text-sm text-primary hover:text-primary/80 underline break-all\"\n                                >\n                                  ðŸ”— Watch on TikTok\n                                </a>\n                              </div>\n                            )}\n                            \n                            {/* Special display for audio/BGM */}\n                            {(suggestion.type === 'audio' || suggestion.type === 'bgm') && (\n                              <div className=\"mb-3 p-3 bg-purple-50/50 dark:bg-purple-950/20 border border-purple-200/50 dark:border-purple-800/50 rounded-lg\">\n                                <Badge className=\"bg-purple-100 text-purple-700 border-purple-300 text-xs mb-2\">\n                                  ðŸŽµ Trending Audio\n                                </Badge>\n                              </div>\n                            )}\n                            \n                            <div className=\"bg-muted/30 rounded-lg p-3 mb-2\">\n                              <p className=\"text-sm text-foreground font-sans leading-relaxed\">{suggestion.content}</p>\n                            </div>\n                            <div className=\"flex items-center justify-between\">\n                              <p className=\"text-xs text-muted-foreground italic font-sans\">ðŸ’¡ {suggestion.reasoning}</p>\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                {Math.round(suggestion.confidence_score * 100)}% confidence\n                              </Badge>\n                            </div>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n\n              {/* Empty state when no video */}\n              {!uploadedVideo && (\n                <Card className=\"border-border/50 shadow-lg bg-card/95 backdrop-blur-sm\">\n                  <CardContent className=\"pt-12 pb-12 text-center\">\n                    <div className=\"flex flex-col items-center gap-4\">\n                      <div className=\"w-16 h-16 rounded-xl bg-muted flex items-center justify-center\">\n                        <Video className=\"w-8 h-8 text-muted-foreground\" />\n                      </div>\n                      <div>\n                        <h3 className=\"font-semibold text-foreground font-display mb-2\">Upload Your Footage</h3>\n                        <p className=\"text-sm text-muted-foreground\">\n                          Video editor will appear here once you upload\n                        </p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}