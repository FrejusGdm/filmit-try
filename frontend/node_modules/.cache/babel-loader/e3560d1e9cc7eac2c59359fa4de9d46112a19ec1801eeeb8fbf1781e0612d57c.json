{"ast":null,"code":"import _objectSpread from\"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect}from'react';import{Button}from'./ui/button';import{Card,CardContent}from'./ui/card';import{Textarea}from'./ui/textarea';import{Badge}from'./ui/badge';import{Avatar,AvatarFallback}from'./ui/avatar';import{Input}from'./ui/input';import{Sparkles,Upload,X,Send,Video,CheckCircle,XCircle,Film,Loader2,User,Clock,ChevronLeft,FolderOpen,Clapperboard,Download,Settings,Edit2,Trash2,Save,Plus,GripVertical}from'lucide-react';import{toast}from'sonner';import{useNavigate,useParams}from'react-router-dom';import{UserMenu}from'./UserMenu';import{sendDirectorMessage,getDirectorProject,uploadDirectorSegment,assembleProjectVideo,getAssemblyStatus,downloadAssembledVideo,updateShot,addShot,deleteShot,reorderShots}from'../utils/api';import{Dialog,DialogContent,DialogDescription,DialogFooter,DialogHeader,DialogTitle}from\"./ui/dialog\";import{Label}from\"./ui/label\";import{Switch}from\"./ui/switch\";import{Select,SelectContent,SelectItem,SelectTrigger,SelectValue}from\"./ui/select\";import{Progress}from\"./ui/progress\";import{DndContext,closestCenter,KeyboardSensor,PointerSensor,useSensor,useSensors}from'@dnd-kit/core';import{arrayMove,SortableContext,sortableKeyboardCoordinates,useSortable,verticalListSortingStrategy}from'@dnd-kit/sortable';import{CSS}from'@dnd-kit/utilities';// Sortable Shot Card Component\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const SortableShotCard=_ref=>{let{shot,index,projectId,onUpdate,onDelete,uploadingSegment,handleSegmentUpload,handleFeedback}=_ref;const[isEditing,setIsEditing]=useState(false);const[editData,setEditData]=useState({segment_name:shot.segment_name,script:shot.script,visual_guide:shot.visual_guide,duration:shot.duration});const{attributes,listeners,setNodeRef,transform,transition,isDragging}=useSortable({id:shot.segment_name+index});const style={transform:CSS.Transform.toString(transform),transition,opacity:isDragging?0.5:1};const handleSave=async()=>{try{const result=await updateShot(projectId,index,editData);if(result.success){onUpdate(result.shot_list);setIsEditing(false);toast.success('Shot updated successfully!');}}catch(error){console.error('Error updating shot:',error);toast.error('Failed to update shot');}};const handleCancel=()=>{setEditData({segment_name:shot.segment_name,script:shot.script,visual_guide:shot.visual_guide,duration:shot.duration});setIsEditing(false);};const handleDeleteClick=async()=>{console.log('Delete button clicked for shot:',shot.segment_name,'index:',index);const confirmed=window.confirm(\"Are you sure you want to delete \\\"\".concat(shot.segment_name.replace('_',' '),\"\\\"?\"));console.log('User confirmation:',confirmed);if(confirmed){try{console.log('Calling deleteShot API with projectId:',projectId,'index:',index);const result=await deleteShot(projectId,index);console.log('Delete API response:',result);if(result.success){onDelete(result.shot_list);toast.success('Shot deleted successfully!');}else{toast.error('Failed to delete shot');}}catch(error){console.error('Error deleting shot:',error);toast.error(\"Failed to delete shot: \".concat(error.message));}}};return/*#__PURE__*/_jsx(Card,{ref:setNodeRef,style:style,className:\"transition-all \".concat(shot.uploaded?'bg-green-50 border-green-200 dark:bg-green-950/20 dark:border-green-800':'bg-card border-border hover:border-primary/50'),children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-4 pb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 flex-1\",children:[/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread(_objectSpread({},attributes),listeners),{},{className:\"cursor-grab active:cursor-grabbing\",children:/*#__PURE__*/_jsx(GripVertical,{className:\"w-4 h-4 text-muted-foreground\"})})),shot.uploaded?/*#__PURE__*/_jsx(CheckCircle,{className:\"w-5 h-5 text-green-600 flex-shrink-0\"}):/*#__PURE__*/_jsx(Clock,{className:\"w-5 h-5 text-muted-foreground flex-shrink-0\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[isEditing?/*#__PURE__*/_jsx(Input,{value:editData.segment_name,onChange:e=>setEditData(_objectSpread(_objectSpread({},editData),{},{segment_name:e.target.value})),className:\"text-sm font-semibold mb-2\"}):/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-sm text-foreground capitalize\",children:shot.segment_name.replace('_',' ')}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mt-1 flex-wrap\",children:[isEditing?/*#__PURE__*/_jsx(Input,{type:\"number\",value:editData.duration,onChange:e=>setEditData(_objectSpread(_objectSpread({},editData),{},{duration:parseInt(e.target.value)})),className:\"w-16 h-6 text-xs\"}):/*#__PURE__*/_jsxs(Badge,{variant:\"outline\",className:\"text-xs\",children:[shot.duration,\"s\"]}),shot.uploaded&&!isEditing&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleFeedback(shot.segment_name),className:\"text-xs text-primary hover:underline font-semibold\",children:\"Get Feedback\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-1\",children:isEditing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"ghost\",onClick:handleSave,className:\"h-8 w-8 p-0\",children:/*#__PURE__*/_jsx(Save,{className:\"w-4 h-4 text-green-600\"})}),/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"ghost\",onClick:handleCancel,className:\"h-8 w-8 p-0\",children:/*#__PURE__*/_jsx(X,{className:\"w-4 h-4 text-red-600\"})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"ghost\",onClick:()=>setIsEditing(true),className:\"h-8 w-8 p-0\",children:/*#__PURE__*/_jsx(Edit2,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(Button,{type:\"button\",size:\"sm\",variant:\"ghost\",onClick:e=>{e.stopPropagation();handleDeleteClick();},className:\"h-8 w-8 p-0\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4 text-red-600\"})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 text-xs\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-foreground\",children:\"Script:\"}),isEditing?/*#__PURE__*/_jsx(Textarea,{value:editData.script,onChange:e=>setEditData(_objectSpread(_objectSpread({},editData),{},{script:e.target.value})),className:\"mt-1 text-xs min-h-[60px]\"}):/*#__PURE__*/_jsx(\"p\",{className:\"text-muted-foreground mt-1\",children:shot.script})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-foreground\",children:\"Visual Guide:\"}),isEditing?/*#__PURE__*/_jsx(Textarea,{value:editData.visual_guide,onChange:e=>setEditData(_objectSpread(_objectSpread({},editData),{},{visual_guide:e.target.value})),className:\"mt-1 text-xs min-h-[60px]\"}):/*#__PURE__*/_jsx(\"p\",{className:\"text-muted-foreground mt-1\",children:shot.visual_guide})]})]}),!shot.uploaded&&!isEditing&&/*#__PURE__*/_jsx(Button,{size:\"sm\",onClick:()=>{const input=document.createElement('input');input.type='file';input.accept='video/*';input.onchange=e=>{const file=e.target.files[0];if(file)handleSegmentUpload(shot,file);};input.click();},disabled:uploadingSegment===shot.segment_name,className:\"w-full\",variant:\"outline\",children:uploadingSegment===shot.segment_name?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Loader2,{className:\"w-4 h-4 mr-2 animate-spin\"}),\"Uploading...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Upload,{className:\"w-4 h-4 mr-2\"}),\"Upload Footage\"]})})]})})});};// Function to convert markdown to plain text\nconst markdownToPlainText=text=>{if(!text)return'';return text// Remove headers (###, ##, #)\n.replace(/^#{1,6}\\s+/gm,'')// Remove bold (**text** or __text__)\n.replace(/(\\*\\*|__)(.*?)\\1/g,'$2')// Remove italic (*text* or _text_)\n.replace(/(\\*|_)(.*?)\\1/g,'$2')// Remove strikethrough (~~text~~)\n.replace(/~~(.*?)~~/g,'$1')// Remove inline code (`code`)\n.replace(/`([^`]+)`/g,'$1')// Remove code blocks (```code```)\n.replace(/```[\\s\\S]*?```/g,'')// Remove links [text](url)\n.replace(/\\[([^\\]]+)\\]\\([^)]+\\)/g,'$1')// Remove images ![alt](url)\n.replace(/!\\[([^\\]]*)\\]\\([^)]+\\)/g,'$1')// Remove horizontal rules (---, ___, ***)\n.replace(/^[\\*\\-_]{3,}\\s*$/gm,'')// Remove blockquotes (>)\n.replace(/^>\\s+/gm,'')// Remove list markers (-, *, +, 1.)\n.replace(/^\\s*[-\\*\\+]\\s+/gm,'â€¢ ').replace(/^\\s*\\d+\\.\\s+/gm,'')// Remove extra whitespace\n.replace(/\\n{3,}/g,'\\n\\n').trim();};// Function to extract clean user goal without research context\nconst extractCleanUserGoal=userGoal=>{if(!userGoal)return'';// Split by research context marker and return only the first part\nconst parts=userGoal.split(/\\[Research Context for AI Director\\]:/i);return parts[0].trim();};export const ContentStudio=()=>{const navigate=useNavigate();const{projectId}=useParams();const[project,setProject]=useState(null);const[messages,setMessages]=useState([]);const[inputValue,setInputValue]=useState('');const[isProcessing,setIsProcessing]=useState(false);const[shotList,setShotList]=useState([]);const[matchedFormat,setMatchedFormat]=useState(null);const[uploadingSegment,setUploadingSegment]=useState(null);const[showAddShot,setShowAddShot]=useState(false);const[newShotData,setNewShotData]=useState({segment_name:'',script:'',visual_guide:'',duration:15});// Assembly state\nconst[showAssemblyDialog,setShowAssemblyDialog]=useState(false);const[isAssembling,setIsAssembling]=useState(false);const[assemblyId,setAssemblyId]=useState(null);const[assemblyProgress,setAssemblyProgress]=useState(0);const[assemblyStatus,setAssemblyStatus]=useState(null);const[assemblyOptions,setAssemblyOptions]=useState({add_transitions:true,transition_type:'fade',transition_duration:0.8,add_subtitles:true,subtitle_position:'bottom',subtitle_font_size:48,optimize_platform:'youtube'});const textareaRef=useRef(null);const messagesEndRef=useRef(null);const fileInputRef=useRef(null);// Drag and drop sensors\nconst sensors=useSensors(useSensor(PointerSensor),useSensor(KeyboardSensor,{coordinateGetter:sortableKeyboardCoordinates}));const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};useEffect(()=>{scrollToBottom();},[messages]);// Load project on mount\nuseEffect(()=>{loadProject();},[projectId]);const loadProject=async()=>{try{const projectData=await getDirectorProject(projectId);setProject(projectData);if(projectData.shot_list){setShotList(projectData.shot_list);}if(projectData.matched_format){setMatchedFormat(projectData.matched_format);}// Initialize messages with brief summary\nconst shotCount=projectData.shot_list?projectData.shot_list.length:0;const formatName=projectData.matched_format?projectData.matched_format.name:'a viral format';const platform=projectData.target_platform||'your platform';const summary=\"You're creating content for \".concat(platform,\" using the \\\"\").concat(formatName,\"\\\" format with \").concat(shotCount,\" shots to film.\");setMessages([{role:'assistant',content:\"I've created your shot list based on the best viral format for your content. \".concat(summary,\" Ready to start recording?\"),timestamp:new Date()}]);}catch(error){console.error('Error loading project:',error);toast.error('Failed to load project');}};const handleSendMessage=async()=>{if(!inputValue.trim())return;setIsProcessing(true);const userMessage={role:'user',content:inputValue.trim(),timestamp:new Date()};setMessages(prev=>[...prev,userMessage]);setInputValue('');try{const result=await sendDirectorMessage(projectId,userMessage.content);const aiMessage={role:'assistant',content:result.message,timestamp:new Date()};setMessages(prev=>[...prev,aiMessage]);// Update state from result\nif(result.shot_list){setShotList(result.shot_list);}if(result.matched_format){setMatchedFormat(result.matched_format);}}catch(error){console.error('Director error:',error);toast.error('Failed to send message');}finally{setIsProcessing(false);}};const handleKeyDown=e=>{if(e.key==='Enter'&&(e.metaKey||e.ctrlKey)){handleSendMessage();}};const handleSegmentUpload=async(segment,file)=>{if(!file.type.startsWith('video/')){toast.error('Please upload a video file');return;}setUploadingSegment(segment.segment_name);try{await uploadDirectorSegment(projectId,segment.segment_name,file);toast.success(\"\".concat(segment.segment_name,\" uploaded successfully!\"));// Update shot list\nsetShotList(prev=>prev.map(s=>s.segment_name===segment.segment_name?_objectSpread(_objectSpread({},s),{},{uploaded:true}):s));// Reload project to get latest state\nawait loadProject();}catch(error){console.error('Upload error:',error);toast.error('Failed to upload segment');}finally{setUploadingSegment(null);}};const allSegmentsUploaded=()=>{return shotList.length>0&&shotList.every(shot=>shot.uploaded);};const handleStartAssembly=async()=>{setIsAssembling(true);setAssemblyProgress(0);try{const result=await assembleProjectVideo(projectId,assemblyOptions);setAssemblyId(result.assembly_id);setAssemblyStatus('processing');toast.success('Video assembly started!');// Start polling for status\npollAssemblyStatus(result.assembly_id);}catch(error){console.error('Assembly error:',error);toast.error('Failed to start video assembly');setIsAssembling(false);}};const pollAssemblyStatus=async id=>{const checkStatus=async()=>{try{const status=await getAssemblyStatus(id);setAssemblyProgress(status.progress);setAssemblyStatus(status.status);if(status.status==='completed'){setIsAssembling(false);toast.success('Video assembly complete! Ready to download.');}else if(status.status==='failed'){setIsAssembling(false);toast.error(\"Assembly failed: \".concat(status.error||'Unknown error'));}else{// Continue polling\nsetTimeout(()=>checkStatus(),2000);}}catch(error){console.error('Status check error:',error);setIsAssembling(false);toast.error('Failed to check assembly status');}};checkStatus();};const handleDownloadVideo=async()=>{try{await downloadAssembledVideo(assemblyId);toast.success('Video download started!');}catch(error){console.error('Download error:',error);toast.error('Failed to download video');}};const handleDragEnd=async event=>{const{active,over}=event;if(active.id!==over.id){const oldIndex=shotList.findIndex((shot,idx)=>shot.segment_name+idx===active.id);const newIndex=shotList.findIndex((shot,idx)=>shot.segment_name+idx===over.id);const newShotList=arrayMove(shotList,oldIndex,newIndex);setShotList(newShotList);try{await reorderShots(projectId,newShotList);toast.success('Shot list reordered!');}catch(error){console.error('Error reordering shots:',error);toast.error('Failed to reorder shots');setShotList(shotList);// Revert on error\n}}};const handleAddShot=async()=>{if(!newShotData.segment_name.trim()||!newShotData.script.trim()){toast.error('Please fill in shot name and script');return;}try{const result=await addShot(projectId,newShotData);if(result.success){setShotList(result.shot_list);setShowAddShot(false);setNewShotData({segment_name:'',script:'',visual_guide:'',duration:15});toast.success('Shot added successfully!');}}catch(error){console.error('Error adding shot:',error);toast.error('Failed to add shot');}};const handleFeedback=async segmentName=>{const msg=\"Can you give me feedback on the \".concat(segmentName.replace('_',' '),\" shot?\");setInputValue(msg);setIsProcessing(true);const userMessage={role:'user',content:msg,timestamp:new Date()};setMessages(prev=>[...prev,userMessage]);setInputValue('');try{const result=await sendDirectorMessage(projectId,msg);const aiMessage={role:'assistant',content:result.message,timestamp:new Date()};setMessages(prev=>[...prev,aiMessage]);if(result.shot_list)setShotList(result.shot_list);}catch(error){console.error('Error:',error);toast.error('Failed to get feedback');}finally{setIsProcessing(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-sky\",children:[/*#__PURE__*/_jsx(\"nav\",{className:\"border-b border-border/50 bg-background/80 backdrop-blur-md sticky top-0 z-50\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-full px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center h-16\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"ghost\",size:\"sm\",onClick:()=>navigate('/director'),className:\"gap-2\",children:[/*#__PURE__*/_jsx(ChevronLeft,{className:\"w-4 h-4\"}),\"Back to Home\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"h-6 w-px bg-border\"}),/*#__PURE__*/_jsxs(Badge,{className:\"bg-primary/20 text-primary border-primary/30 font-sans animate-pulse\",children:[/*#__PURE__*/_jsx(Film,{className:\"w-3 h-3 mr-1\"}),\"Content Studio\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsxs(Button,{variant:\"outline\",size:\"sm\",onClick:()=>navigate('/director/projects'),className:\"gap-2\",children:[/*#__PURE__*/_jsx(FolderOpen,{className:\"w-4 h-4\"}),\"All Projects\"]}),/*#__PURE__*/_jsx(UserMenu,{})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex h-[calc(100vh-4rem)]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-1/3 border-r border-border/50 bg-background/50 backdrop-blur-sm overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[project&&/*#__PURE__*/_jsx(Card,{className:\"border-primary/30 bg-primary/5\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-4 pb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold text-muted-foreground mb-2\",children:\"Project Goal\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-foreground\",children:extractCleanUserGoal(project.user_goal)})]})}),matchedFormat&&/*#__PURE__*/_jsx(Card,{className:\"border-accent/30 bg-accent/5\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-4 pb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(Sparkles,{className:\"w-4 h-4 text-accent-foreground\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-semibold text-foreground\",children:\"Matched Format\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold text-foreground mb-1\",children:matchedFormat.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-muted-foreground\",children:matchedFormat.description})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-foreground\",children:\"Shot List\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(Badge,{variant:\"outline\",className:\"text-xs\",children:[shotList.filter(s=>s.uploaded).length,\" / \",shotList.length]}),/*#__PURE__*/_jsxs(Button,{size:\"sm\",onClick:()=>setShowAddShot(true),className:\"gap-1 h-7\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),\"Add Shot\"]})]}),allSegmentsUploaded()&&/*#__PURE__*/_jsx(Card,{className:\"border-green-200 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 dark:border-green-800\",children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-6 pb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center\",children:/*#__PURE__*/_jsx(CheckCircle,{className:\"w-6 h-6 text-white\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-foreground\",children:\"All Shots Complete!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-muted-foreground\",children:\"Ready to assemble your final video\"})]})]}),!isAssembling&&!assemblyId&&/*#__PURE__*/_jsxs(Button,{onClick:()=>setShowAssemblyDialog(true),className:\"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-semibold\",size:\"lg\",children:[/*#__PURE__*/_jsx(Clapperboard,{className:\"w-5 h-5 mr-2\"}),\"Generate Final Video\"]}),isAssembling&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-muted-foreground\",children:\"Assembling video...\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold text-foreground\",children:[assemblyProgress,\"%\"]})]}),/*#__PURE__*/_jsx(Progress,{value:assemblyProgress,className:\"h-2\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-muted-foreground\",children:[assemblyProgress<30&&\"Processing segments...\",assemblyProgress>=30&&assemblyProgress<60&&\"Adding transitions...\",assemblyProgress>=60&&assemblyProgress<90&&\"Optimizing video...\",assemblyProgress>=90&&\"Finalizing...\"]})]}),assemblyStatus==='completed'&&assemblyId&&/*#__PURE__*/_jsxs(Button,{onClick:handleDownloadVideo,className:\"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold\",size:\"lg\",children:[/*#__PURE__*/_jsx(Download,{className:\"w-5 h-5 mr-2\"}),\"Download Final Video\"]})]})})})]}),showAddShot&&/*#__PURE__*/_jsx(Card,{className:\"border-primary/30 bg-primary/5\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-4 pb-4 space-y-3\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-sm\",children:\"Add New Shot\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Input,{placeholder:\"Shot name (e.g., hook, demo)\",value:newShotData.segment_name,onChange:e=>setNewShotData(_objectSpread(_objectSpread({},newShotData),{},{segment_name:e.target.value})),className:\"text-sm\"}),/*#__PURE__*/_jsx(Textarea,{placeholder:\"Script for this shot\",value:newShotData.script,onChange:e=>setNewShotData(_objectSpread(_objectSpread({},newShotData),{},{script:e.target.value})),className:\"text-sm min-h-[60px]\"}),/*#__PURE__*/_jsx(Textarea,{placeholder:\"Visual guide (how to film)\",value:newShotData.visual_guide,onChange:e=>setNewShotData(_objectSpread(_objectSpread({},newShotData),{},{visual_guide:e.target.value})),className:\"text-sm min-h-[60px]\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs text-muted-foreground\",children:\"Duration (seconds):\"}),/*#__PURE__*/_jsx(Input,{type:\"number\",value:newShotData.duration,onChange:e=>setNewShotData(_objectSpread(_objectSpread({},newShotData),{},{duration:parseInt(e.target.value)})),className:\"w-20 h-8 text-sm\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(Button,{size:\"sm\",onClick:handleAddShot,className:\"flex-1\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4 mr-1\"}),\"Add Shot\"]}),/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"outline\",onClick:()=>{setShowAddShot(false);setNewShotData({segment_name:'',script:'',visual_guide:'',duration:15});},className:\"flex-1\",children:\"Cancel\"})]})]})}),shotList.length>0&&/*#__PURE__*/_jsx(DndContext,{sensors:sensors,collisionDetection:closestCenter,onDragEnd:handleDragEnd,children:/*#__PURE__*/_jsx(SortableContext,{items:shotList.map((shot,idx)=>shot.segment_name+idx),strategy:verticalListSortingStrategy,children:/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:shotList.map((shot,index)=>/*#__PURE__*/_jsx(SortableShotCard,{shot:shot,index:index,projectId:projectId,onUpdate:setShotList,onDelete:setShotList,uploadingSegment:uploadingSegment,handleSegmentUpload:handleSegmentUpload,handleFeedback:handleFeedback},shot.segment_name+index))})})})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto p-6 space-y-4\",children:[messages.map((message,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 \".concat(message.role==='user'?'justify-end':'justify-start'),children:[message.role==='assistant'&&/*#__PURE__*/_jsx(Avatar,{className:\"w-10 h-10 border-2 border-primary/20 flex-shrink-0\",children:/*#__PURE__*/_jsx(AvatarFallback,{className:\"bg-gradient-primary text-primary-foreground\",children:/*#__PURE__*/_jsx(Sparkles,{className:\"w-5 h-5\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 max-w-2xl \".concat(message.role==='user'?'flex flex-col items-end':''),children:[/*#__PURE__*/_jsx(Card,{className:\"\".concat(message.role==='user'?'bg-primary text-primary-foreground border-primary':'bg-card/95 backdrop-blur-sm border-border/50',\" shadow-lg\"),children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-4 pb-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-sm leading-relaxed whitespace-pre-wrap font-sans\",children:message.role==='assistant'?markdownToPlainText(message.content):message.content})})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-muted-foreground mt-1.5 font-sans\",children:message.timestamp.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})})]}),message.role==='user'&&/*#__PURE__*/_jsx(Avatar,{className:\"w-10 h-10 border-2 border-primary/20 flex-shrink-0\",children:/*#__PURE__*/_jsx(AvatarFallback,{className:\"bg-muted text-muted-foreground\",children:/*#__PURE__*/_jsx(User,{className:\"w-5 h-5\"})})})]},index)),isProcessing&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 justify-start\",children:[/*#__PURE__*/_jsx(Avatar,{className:\"w-10 h-10 border-2 border-primary/20\",children:/*#__PURE__*/_jsx(AvatarFallback,{className:\"bg-gradient-primary text-primary-foreground\",children:/*#__PURE__*/_jsx(Sparkles,{className:\"w-5 h-5\"})})}),/*#__PURE__*/_jsx(Card,{className:\"bg-card/95 backdrop-blur-sm border-border/50 shadow-lg\",children:/*#__PURE__*/_jsx(CardContent,{className:\"pt-4 pb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full bg-primary animate-bounce\",style:{animationDelay:'0s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full bg-primary animate-bounce\",style:{animationDelay:'0.2s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full bg-primary animate-bounce\",style:{animationDelay:'0.4s'}})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-muted-foreground font-sans\",children:\"Thinking...\"})]})})})]}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-border/50 bg-background/80 backdrop-blur-sm p-6\",children:[shotList.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 mb-4\",children:[/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"sm\",onClick:()=>{var _textareaRef$current;setInputValue(\"Please provide a comprehensive project status. Include: 1) Overall creative vision and format we're using, 2) Complete shot list with what's been filmed and what's remaining, 3) Quality assessment of uploaded shots so far, 4) Any creative adjustments or suggestions based on progress, 5) Estimated completion percentage and next steps.\");(_textareaRef$current=textareaRef.current)===null||_textareaRef$current===void 0?void 0:_textareaRef$current.focus();},className:\"text-xs\",children:\"\\uD83D\\uDCCA Project Status\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"sm\",onClick:()=>{var _textareaRef$current2;setInputValue(\"Please explain the next shot I need to record. Include: 1) Which shot it is in the sequence, 2) What the script and visual guide are for this shot, 3) Any specific tips or techniques for filming this shot effectively, 4) How this shot fits into the overall narrative. Do I have any questions before I start filming?\");(_textareaRef$current2=textareaRef.current)===null||_textareaRef$current2===void 0?void 0:_textareaRef$current2.focus();},className:\"text-xs\",children:\"\\uD83C\\uDFA5 Next Shot\"}),shotList.some(s=>s.uploaded)&&/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"sm\",onClick:()=>{var _textareaRef$current3;setInputValue(\"Can you review all my uploaded shots?\");(_textareaRef$current3=textareaRef.current)===null||_textareaRef$current3===void 0?void 0:_textareaRef$current3.focus();},className:\"text-xs\",children:\"\\u2728 Review Uploads\"})]}),/*#__PURE__*/_jsx(Card,{className:\"border-border/50 shadow-xl bg-card/95 backdrop-blur-sm\",children:/*#__PURE__*/_jsxs(CardContent,{className:\"pt-4 pb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(Textarea,{ref:textareaRef,value:inputValue,onChange:e=>setInputValue(e.target.value),onKeyDown:handleKeyDown,placeholder:\"Ask me anything about your video or tell me you're ready to record...\",className:\"min-h-[80px] resize-none focus:ring-primary font-sans text-base\",disabled:isProcessing}),/*#__PURE__*/_jsx(Button,{onClick:handleSendMessage,disabled:isProcessing||!inputValue.trim(),className:\"bg-gradient-primary hover:shadow-glow self-end px-5 h-[80px] transition-all duration-300\",children:/*#__PURE__*/_jsx(Send,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-muted-foreground mt-2 font-sans\",children:[\"Press \",/*#__PURE__*/_jsx(\"kbd\",{className:\"px-2 py-1 bg-muted rounded text-xs\",children:\"\\u2318 Enter\"}),\" to send\"]})]})})]})]})]}),/*#__PURE__*/_jsx(Dialog,{open:showAssemblyDialog,onOpenChange:setShowAssemblyDialog,children:/*#__PURE__*/_jsxs(DialogContent,{className:\"sm:max-w-[600px]\",children:[/*#__PURE__*/_jsxs(DialogHeader,{children:[/*#__PURE__*/_jsxs(DialogTitle,{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Settings,{className:\"w-5 h-5\"}),\"Configure Video Assembly\"]}),/*#__PURE__*/_jsx(DialogDescription,{children:\"Customize how your final video will be assembled. Add transitions, subtitles, and optimize for your target platform.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6 py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"transitions\",className:\"text-base font-semibold\",children:\"Add Transitions\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground\",children:\"Smooth transitions between shots\"})]}),/*#__PURE__*/_jsx(Switch,{id:\"transitions\",checked:assemblyOptions.add_transitions,onCheckedChange:checked=>setAssemblyOptions(prev=>_objectSpread(_objectSpread({},prev),{},{add_transitions:checked}))})]}),assemblyOptions.add_transitions&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 pl-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"transition-type\",children:\"Transition Type\"}),/*#__PURE__*/_jsxs(Select,{value:assemblyOptions.transition_type,onValueChange:value=>setAssemblyOptions(prev=>_objectSpread(_objectSpread({},prev),{},{transition_type:value})),children:[/*#__PURE__*/_jsx(SelectTrigger,{id:\"transition-type\",children:/*#__PURE__*/_jsx(SelectValue,{})}),/*#__PURE__*/_jsxs(SelectContent,{children:[/*#__PURE__*/_jsx(SelectItem,{value:\"fade\",children:\"Fade\"}),/*#__PURE__*/_jsx(SelectItem,{value:\"wipe\",children:\"Wipe\"}),/*#__PURE__*/_jsx(SelectItem,{value:\"dissolve\",children:\"Dissolve\"}),/*#__PURE__*/_jsx(SelectItem,{value:\"slidedown\",children:\"Slide Down\"}),/*#__PURE__*/_jsx(SelectItem,{value:\"slideup\",children:\"Slide Up\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"transition-duration\",children:\"Duration (seconds)\"}),/*#__PURE__*/_jsx(\"input\",{id:\"transition-duration\",type:\"number\",min:\"0.1\",max:\"2\",step:\"0.1\",value:assemblyOptions.transition_duration,onChange:e=>setAssemblyOptions(prev=>_objectSpread(_objectSpread({},prev),{},{transition_duration:parseFloat(e.target.value)})),className:\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t pt-4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"subtitles\",className:\"text-base font-semibold\",children:\"Add Subtitles\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground\",children:\"Auto-generated from shot scripts\"})]}),/*#__PURE__*/_jsx(Switch,{id:\"subtitles\",checked:assemblyOptions.add_subtitles,onCheckedChange:checked=>setAssemblyOptions(prev=>_objectSpread(_objectSpread({},prev),{},{add_subtitles:checked}))})]}),assemblyOptions.add_subtitles&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 pl-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"subtitle-position\",children:\"Position\"}),/*#__PURE__*/_jsxs(Select,{value:assemblyOptions.subtitle_position,onValueChange:value=>setAssemblyOptions(prev=>_objectSpread(_objectSpread({},prev),{},{subtitle_position:value})),children:[/*#__PURE__*/_jsx(SelectTrigger,{id:\"subtitle-position\",children:/*#__PURE__*/_jsx(SelectValue,{})}),/*#__PURE__*/_jsxs(SelectContent,{children:[/*#__PURE__*/_jsx(SelectItem,{value:\"top\",children:\"Top\"}),/*#__PURE__*/_jsx(SelectItem,{value:\"center\",children:\"Center\"}),/*#__PURE__*/_jsx(SelectItem,{value:\"bottom\",children:\"Bottom\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"subtitle-size\",children:\"Font Size\"}),/*#__PURE__*/_jsx(\"input\",{id:\"subtitle-size\",type:\"number\",min:\"24\",max:\"72\",step:\"4\",value:assemblyOptions.subtitle_font_size,onChange:e=>setAssemblyOptions(prev=>_objectSpread(_objectSpread({},prev),{},{subtitle_font_size:parseInt(e.target.value)})),className:\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t pt-4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"platform\",className:\"text-base font-semibold\",children:\"Optimize for Platform\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-muted-foreground mb-3\",children:\"Adjust resolution and format for best results\"})]}),/*#__PURE__*/_jsxs(Select,{value:assemblyOptions.optimize_platform,onValueChange:value=>setAssemblyOptions(prev=>_objectSpread(_objectSpread({},prev),{},{optimize_platform:value})),children:[/*#__PURE__*/_jsx(SelectTrigger,{id:\"platform\",children:/*#__PURE__*/_jsx(SelectValue,{})}),/*#__PURE__*/_jsxs(SelectContent,{children:[/*#__PURE__*/_jsx(SelectItem,{value:\"youtube\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Video,{className:\"w-4 h-4\"}),\"YouTube (1920x1080, 16:9)\"]})}),/*#__PURE__*/_jsx(SelectItem,{value:\"tiktok\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Film,{className:\"w-4 h-4\"}),\"TikTok (1080x1920, 9:16)\"]})}),/*#__PURE__*/_jsx(SelectItem,{value:\"instagram\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Film,{className:\"w-4 h-4\"}),\"Instagram Reels (1080x1920, 9:16)\"]})})]})]})]})]}),/*#__PURE__*/_jsxs(DialogFooter,{children:[/*#__PURE__*/_jsx(Button,{variant:\"outline\",onClick:()=>setShowAssemblyDialog(false),children:\"Cancel\"}),/*#__PURE__*/_jsxs(Button,{onClick:()=>{setShowAssemblyDialog(false);handleStartAssembly();},className:\"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white\",children:[/*#__PURE__*/_jsx(Clapperboard,{className:\"w-4 h-4 mr-2\"}),\"Start Assembly\"]})]})]})})]});};","map":{"version":3,"names":["React","useState","useRef","useEffect","Button","Card","CardContent","Textarea","Badge","Avatar","AvatarFallback","Input","Sparkles","Upload","X","Send","Video","CheckCircle","XCircle","Film","Loader2","User","Clock","ChevronLeft","FolderOpen","Clapperboard","Download","Settings","Edit2","Trash2","Save","Plus","GripVertical","toast","useNavigate","useParams","UserMenu","sendDirectorMessage","getDirectorProject","uploadDirectorSegment","assembleProjectVideo","getAssemblyStatus","downloadAssembledVideo","updateShot","addShot","deleteShot","reorderShots","Dialog","DialogContent","DialogDescription","DialogFooter","DialogHeader","DialogTitle","Label","Switch","Select","SelectContent","SelectItem","SelectTrigger","SelectValue","Progress","DndContext","closestCenter","KeyboardSensor","PointerSensor","useSensor","useSensors","arrayMove","SortableContext","sortableKeyboardCoordinates","useSortable","verticalListSortingStrategy","CSS","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SortableShotCard","_ref","shot","index","projectId","onUpdate","onDelete","uploadingSegment","handleSegmentUpload","handleFeedback","isEditing","setIsEditing","editData","setEditData","segment_name","script","visual_guide","duration","attributes","listeners","setNodeRef","transform","transition","isDragging","id","style","Transform","toString","opacity","handleSave","result","success","shot_list","error","console","handleCancel","handleDeleteClick","log","confirmed","window","confirm","concat","replace","message","ref","className","uploaded","children","_objectSpread","value","onChange","e","target","type","parseInt","variant","onClick","size","stopPropagation","input","document","createElement","accept","onchange","file","files","click","disabled","markdownToPlainText","text","trim","extractCleanUserGoal","userGoal","parts","split","ContentStudio","navigate","project","setProject","messages","setMessages","inputValue","setInputValue","isProcessing","setIsProcessing","shotList","setShotList","matchedFormat","setMatchedFormat","setUploadingSegment","showAddShot","setShowAddShot","newShotData","setNewShotData","showAssemblyDialog","setShowAssemblyDialog","isAssembling","setIsAssembling","assemblyId","setAssemblyId","assemblyProgress","setAssemblyProgress","assemblyStatus","setAssemblyStatus","assemblyOptions","setAssemblyOptions","add_transitions","transition_type","transition_duration","add_subtitles","subtitle_position","subtitle_font_size","optimize_platform","textareaRef","messagesEndRef","fileInputRef","sensors","coordinateGetter","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","loadProject","projectData","matched_format","shotCount","length","formatName","name","platform","target_platform","summary","role","content","timestamp","Date","handleSendMessage","userMessage","prev","aiMessage","handleKeyDown","key","metaKey","ctrlKey","segment","startsWith","map","s","allSegmentsUploaded","every","handleStartAssembly","assembly_id","pollAssemblyStatus","checkStatus","status","progress","setTimeout","handleDownloadVideo","handleDragEnd","event","active","over","oldIndex","findIndex","idx","newIndex","newShotList","handleAddShot","segmentName","msg","user_goal","description","filter","placeholder","collisionDetection","onDragEnd","items","strategy","toLocaleTimeString","hour","minute","animationDelay","_textareaRef$current","focus","_textareaRef$current2","some","_textareaRef$current3","onKeyDown","open","onOpenChange","htmlFor","checked","onCheckedChange","onValueChange","min","max","step","parseFloat"],"sources":["/app/frontend/src/components/ContentStudio.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { Button } from './ui/button';\nimport { Card, CardContent } from './ui/card';\nimport { Textarea } from './ui/textarea';\nimport { Badge } from './ui/badge';\nimport { Avatar, AvatarFallback } from './ui/avatar';\nimport { Input } from './ui/input';\nimport { \n  Sparkles, Upload, X, Send, Video, CheckCircle, XCircle, \n  Film, Loader2, User, Clock, ChevronLeft, FolderOpen, Clapperboard,\n  Download, Settings, Edit2, Trash2, Save, Plus, GripVertical\n} from 'lucide-react';\nimport { toast } from 'sonner';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { UserMenu } from './UserMenu';\nimport {\n  sendDirectorMessage,\n  getDirectorProject,\n  uploadDirectorSegment,\n  assembleProjectVideo,\n  getAssemblyStatus,\n  downloadAssembledVideo,\n  updateShot,\n  addShot,\n  deleteShot,\n  reorderShots\n} from '../utils/api';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"./ui/dialog\";\nimport { Label } from \"./ui/label\";\nimport { Switch } from \"./ui/switch\";\nimport { \n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"./ui/select\";\nimport { Progress } from \"./ui/progress\";\nimport {\n  DndContext,\n  closestCenter,\n  KeyboardSensor,\n  PointerSensor,\n  useSensor,\n  useSensors,\n} from '@dnd-kit/core';\nimport {\n  arrayMove,\n  SortableContext,\n  sortableKeyboardCoordinates,\n  useSortable,\n  verticalListSortingStrategy,\n} from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\n\n// Sortable Shot Card Component\nconst SortableShotCard = ({ shot, index, projectId, onUpdate, onDelete, uploadingSegment, handleSegmentUpload, handleFeedback }) => {\n  const [isEditing, setIsEditing] = useState(false);\n  const [editData, setEditData] = useState({\n    segment_name: shot.segment_name,\n    script: shot.script,\n    visual_guide: shot.visual_guide,\n    duration: shot.duration\n  });\n\n  const {\n    attributes,\n    listeners,\n    setNodeRef,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({ id: shot.segment_name + index });\n\n  const style = {\n    transform: CSS.Transform.toString(transform),\n    transition,\n    opacity: isDragging ? 0.5 : 1,\n  };\n\n  const handleSave = async () => {\n    try {\n      const result = await updateShot(projectId, index, editData);\n      if (result.success) {\n        onUpdate(result.shot_list);\n        setIsEditing(false);\n        toast.success('Shot updated successfully!');\n      }\n    } catch (error) {\n      console.error('Error updating shot:', error);\n      toast.error('Failed to update shot');\n    }\n  };\n\n  const handleCancel = () => {\n    setEditData({\n      segment_name: shot.segment_name,\n      script: shot.script,\n      visual_guide: shot.visual_guide,\n      duration: shot.duration\n    });\n    setIsEditing(false);\n  };\n\n  const handleDeleteClick = async () => {\n    console.log('Delete button clicked for shot:', shot.segment_name, 'index:', index);\n    \n    const confirmed = window.confirm(`Are you sure you want to delete \"${shot.segment_name.replace('_', ' ')}\"?`);\n    console.log('User confirmation:', confirmed);\n    \n    if (confirmed) {\n      try {\n        console.log('Calling deleteShot API with projectId:', projectId, 'index:', index);\n        const result = await deleteShot(projectId, index);\n        console.log('Delete API response:', result);\n        \n        if (result.success) {\n          onDelete(result.shot_list);\n          toast.success('Shot deleted successfully!');\n        } else {\n          toast.error('Failed to delete shot');\n        }\n      } catch (error) {\n        console.error('Error deleting shot:', error);\n        toast.error(`Failed to delete shot: ${error.message}`);\n      }\n    }\n  };\n\n  return (\n    <Card \n      ref={setNodeRef}\n      style={style}\n      className={`transition-all ${\n        shot.uploaded \n          ? 'bg-green-50 border-green-200 dark:bg-green-950/20 dark:border-green-800' \n          : 'bg-card border-border hover:border-primary/50'\n      }`}\n    >\n      <CardContent className=\"pt-4 pb-4\">\n        <div className=\"space-y-3\">\n          <div className=\"flex items-start justify-between gap-2\">\n            <div className=\"flex items-center gap-2 flex-1\">\n              <div {...attributes} {...listeners} className=\"cursor-grab active:cursor-grabbing\">\n                <GripVertical className=\"w-4 h-4 text-muted-foreground\" />\n              </div>\n              {shot.uploaded ? (\n                <CheckCircle className=\"w-5 h-5 text-green-600 flex-shrink-0\" />\n              ) : (\n                <Clock className=\"w-5 h-5 text-muted-foreground flex-shrink-0\" />\n              )}\n              <div className=\"flex-1\">\n                {isEditing ? (\n                  <Input\n                    value={editData.segment_name}\n                    onChange={(e) => setEditData({...editData, segment_name: e.target.value})}\n                    className=\"text-sm font-semibold mb-2\"\n                  />\n                ) : (\n                  <h4 className=\"font-semibold text-sm text-foreground capitalize\">\n                    {shot.segment_name.replace('_', ' ')}\n                  </h4>\n                )}\n                <div className=\"flex items-center gap-2 mt-1 flex-wrap\">\n                  {isEditing ? (\n                    <Input\n                      type=\"number\"\n                      value={editData.duration}\n                      onChange={(e) => setEditData({...editData, duration: parseInt(e.target.value)})}\n                      className=\"w-16 h-6 text-xs\"\n                    />\n                  ) : (\n                    <Badge variant=\"outline\" className=\"text-xs\">\n                      {shot.duration}s\n                    </Badge>\n                  )}\n                  {shot.uploaded && !isEditing && (\n                    <button\n                      onClick={() => handleFeedback(shot.segment_name)}\n                      className=\"text-xs text-primary hover:underline font-semibold\"\n                    >\n                      Get Feedback\n                    </button>\n                  )}\n                </div>\n              </div>\n            </div>\n            <div className=\"flex gap-1\">\n              {isEditing ? (\n                <>\n                  <Button\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    onClick={handleSave}\n                    className=\"h-8 w-8 p-0\"\n                  >\n                    <Save className=\"w-4 h-4 text-green-600\" />\n                  </Button>\n                  <Button\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    onClick={handleCancel}\n                    className=\"h-8 w-8 p-0\"\n                  >\n                    <X className=\"w-4 h-4 text-red-600\" />\n                  </Button>\n                </>\n              ) : (\n                <>\n                  <Button\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    onClick={() => setIsEditing(true)}\n                    className=\"h-8 w-8 p-0\"\n                  >\n                    <Edit2 className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      handleDeleteClick();\n                    }}\n                    className=\"h-8 w-8 p-0\"\n                  >\n                    <Trash2 className=\"w-4 h-4 text-red-600\" />\n                  </Button>\n                </>\n              )}\n            </div>\n          </div>\n          \n          <div className=\"space-y-2 text-xs\">\n            <div>\n              <strong className=\"text-foreground\">Script:</strong>\n              {isEditing ? (\n                <Textarea\n                  value={editData.script}\n                  onChange={(e) => setEditData({...editData, script: e.target.value})}\n                  className=\"mt-1 text-xs min-h-[60px]\"\n                />\n              ) : (\n                <p className=\"text-muted-foreground mt-1\">{shot.script}</p>\n              )}\n            </div>\n            <div>\n              <strong className=\"text-foreground\">Visual Guide:</strong>\n              {isEditing ? (\n                <Textarea\n                  value={editData.visual_guide}\n                  onChange={(e) => setEditData({...editData, visual_guide: e.target.value})}\n                  className=\"mt-1 text-xs min-h-[60px]\"\n                />\n              ) : (\n                <p className=\"text-muted-foreground mt-1\">{shot.visual_guide}</p>\n              )}\n            </div>\n          </div>\n\n          {!shot.uploaded && !isEditing && (\n            <Button\n              size=\"sm\"\n              onClick={() => {\n                const input = document.createElement('input');\n                input.type = 'file';\n                input.accept = 'video/*';\n                input.onchange = (e) => {\n                  const file = e.target.files[0];\n                  if (file) handleSegmentUpload(shot, file);\n                };\n                input.click();\n              }}\n              disabled={uploadingSegment === shot.segment_name}\n              className=\"w-full\"\n              variant=\"outline\"\n            >\n              {uploadingSegment === shot.segment_name ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  Uploading...\n                </>\n              ) : (\n                <>\n                  <Upload className=\"w-4 h-4 mr-2\" />\n                  Upload Footage\n                </>\n              )}\n            </Button>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\n// Function to convert markdown to plain text\nconst markdownToPlainText = (text) => {\n  if (!text) return '';\n  \n  return text\n    // Remove headers (###, ##, #)\n    .replace(/^#{1,6}\\s+/gm, '')\n    // Remove bold (**text** or __text__)\n    .replace(/(\\*\\*|__)(.*?)\\1/g, '$2')\n    // Remove italic (*text* or _text_)\n    .replace(/(\\*|_)(.*?)\\1/g, '$2')\n    // Remove strikethrough (~~text~~)\n    .replace(/~~(.*?)~~/g, '$1')\n    // Remove inline code (`code`)\n    .replace(/`([^`]+)`/g, '$1')\n    // Remove code blocks (```code```)\n    .replace(/```[\\s\\S]*?```/g, '')\n    // Remove links [text](url)\n    .replace(/\\[([^\\]]+)\\]\\([^)]+\\)/g, '$1')\n    // Remove images ![alt](url)\n    .replace(/!\\[([^\\]]*)\\]\\([^)]+\\)/g, '$1')\n    // Remove horizontal rules (---, ___, ***)\n    .replace(/^[\\*\\-_]{3,}\\s*$/gm, '')\n    // Remove blockquotes (>)\n    .replace(/^>\\s+/gm, '')\n    // Remove list markers (-, *, +, 1.)\n    .replace(/^\\s*[-\\*\\+]\\s+/gm, 'â€¢ ')\n    .replace(/^\\s*\\d+\\.\\s+/gm, '')\n    // Remove extra whitespace\n    .replace(/\\n{3,}/g, '\\n\\n')\n    .trim();\n};\n\n// Function to extract clean user goal without research context\nconst extractCleanUserGoal = (userGoal) => {\n  if (!userGoal) return '';\n  \n  // Split by research context marker and return only the first part\n  const parts = userGoal.split(/\\[Research Context for AI Director\\]:/i);\n  return parts[0].trim();\n};\n\nexport const ContentStudio = () => {\n  const navigate = useNavigate();\n  const { projectId } = useParams();\n  \n  const [project, setProject] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [inputValue, setInputValue] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [shotList, setShotList] = useState([]);\n  const [matchedFormat, setMatchedFormat] = useState(null);\n  const [uploadingSegment, setUploadingSegment] = useState(null);\n  const [showAddShot, setShowAddShot] = useState(false);\n  const [newShotData, setNewShotData] = useState({\n    segment_name: '',\n    script: '',\n    visual_guide: '',\n    duration: 15\n  });\n  \n  // Assembly state\n  const [showAssemblyDialog, setShowAssemblyDialog] = useState(false);\n  const [isAssembling, setIsAssembling] = useState(false);\n  const [assemblyId, setAssemblyId] = useState(null);\n  const [assemblyProgress, setAssemblyProgress] = useState(0);\n  const [assemblyStatus, setAssemblyStatus] = useState(null);\n  const [assemblyOptions, setAssemblyOptions] = useState({\n    add_transitions: true,\n    transition_type: 'fade',\n    transition_duration: 0.8,\n    add_subtitles: true,\n    subtitle_position: 'bottom',\n    subtitle_font_size: 48,\n    optimize_platform: 'youtube'\n  });\n  \n  const textareaRef = useRef(null);\n  const messagesEndRef = useRef(null);\n  const fileInputRef = useRef(null);\n  \n  // Drag and drop sensors\n  const sensors = useSensors(\n    useSensor(PointerSensor),\n    useSensor(KeyboardSensor, {\n      coordinateGetter: sortableKeyboardCoordinates,\n    })\n  );\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Load project on mount\n  useEffect(() => {\n    loadProject();\n  }, [projectId]);\n\n  const loadProject = async () => {\n    try {\n      const projectData = await getDirectorProject(projectId);\n      setProject(projectData);\n      \n      if (projectData.shot_list) {\n        setShotList(projectData.shot_list);\n      }\n      if (projectData.matched_format) {\n        setMatchedFormat(projectData.matched_format);\n      }\n      \n      // Initialize messages with brief summary\n      const shotCount = projectData.shot_list ? projectData.shot_list.length : 0;\n      const formatName = projectData.matched_format ? projectData.matched_format.name : 'a viral format';\n      const platform = projectData.target_platform || 'your platform';\n      \n      const summary = `You're creating content for ${platform} using the \"${formatName}\" format with ${shotCount} shots to film.`;\n      \n      setMessages([{\n        role: 'assistant',\n        content: `I've created your shot list based on the best viral format for your content. ${summary} Ready to start recording?`,\n        timestamp: new Date()\n      }]);\n    } catch (error) {\n      console.error('Error loading project:', error);\n      toast.error('Failed to load project');\n    }\n  };\n\n  const handleSendMessage = async () => {\n    if (!inputValue.trim()) return;\n\n    setIsProcessing(true);\n    const userMessage = {\n      role: 'user',\n      content: inputValue.trim(),\n      timestamp: new Date()\n    };\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n\n    try {\n      const result = await sendDirectorMessage(projectId, userMessage.content);\n      \n      const aiMessage = {\n        role: 'assistant',\n        content: result.message,\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, aiMessage]);\n\n      // Update state from result\n      if (result.shot_list) {\n        setShotList(result.shot_list);\n      }\n      if (result.matched_format) {\n        setMatchedFormat(result.matched_format);\n      }\n\n    } catch (error) {\n      console.error('Director error:', error);\n      toast.error('Failed to send message');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' && (e.metaKey || e.ctrlKey)) {\n      handleSendMessage();\n    }\n  };\n\n  const handleSegmentUpload = async (segment, file) => {\n    if (!file.type.startsWith('video/')) {\n      toast.error('Please upload a video file');\n      return;\n    }\n\n    setUploadingSegment(segment.segment_name);\n    try {\n      await uploadDirectorSegment(projectId, segment.segment_name, file);\n      \n      toast.success(`${segment.segment_name} uploaded successfully!`);\n      \n      // Update shot list\n      setShotList(prev => prev.map(s => \n        s.segment_name === segment.segment_name \n          ? { ...s, uploaded: true }\n          : s\n      ));\n      \n      // Reload project to get latest state\n      await loadProject();\n      \n    } catch (error) {\n      console.error('Upload error:', error);\n      toast.error('Failed to upload segment');\n    } finally {\n      setUploadingSegment(null);\n    }\n  };\n\n  const allSegmentsUploaded = () => {\n    return shotList.length > 0 && shotList.every(shot => shot.uploaded);\n  };\n\n  const handleStartAssembly = async () => {\n    setIsAssembling(true);\n    setAssemblyProgress(0);\n    \n    try {\n      const result = await assembleProjectVideo(projectId, assemblyOptions);\n      \n      setAssemblyId(result.assembly_id);\n      setAssemblyStatus('processing');\n      toast.success('Video assembly started!');\n      \n      // Start polling for status\n      pollAssemblyStatus(result.assembly_id);\n      \n    } catch (error) {\n      console.error('Assembly error:', error);\n      toast.error('Failed to start video assembly');\n      setIsAssembling(false);\n    }\n  };\n\n  const pollAssemblyStatus = async (id) => {\n    const checkStatus = async () => {\n      try {\n        const status = await getAssemblyStatus(id);\n        \n        setAssemblyProgress(status.progress);\n        setAssemblyStatus(status.status);\n        \n        if (status.status === 'completed') {\n          setIsAssembling(false);\n          toast.success('Video assembly complete! Ready to download.');\n        } else if (status.status === 'failed') {\n          setIsAssembling(false);\n          toast.error(`Assembly failed: ${status.error || 'Unknown error'}`);\n        } else {\n          // Continue polling\n          setTimeout(() => checkStatus(), 2000);\n        }\n      } catch (error) {\n        console.error('Status check error:', error);\n        setIsAssembling(false);\n        toast.error('Failed to check assembly status');\n      }\n    };\n    \n    checkStatus();\n  };\n\n  const handleDownloadVideo = async () => {\n    try {\n      await downloadAssembledVideo(assemblyId);\n      toast.success('Video download started!');\n    } catch (error) {\n      console.error('Download error:', error);\n      toast.error('Failed to download video');\n    }\n  };\n\n  const handleDragEnd = async (event) => {\n    const { active, over } = event;\n\n    if (active.id !== over.id) {\n      const oldIndex = shotList.findIndex((shot, idx) => shot.segment_name + idx === active.id);\n      const newIndex = shotList.findIndex((shot, idx) => shot.segment_name + idx === over.id);\n\n      const newShotList = arrayMove(shotList, oldIndex, newIndex);\n      setShotList(newShotList);\n\n      try {\n        await reorderShots(projectId, newShotList);\n        toast.success('Shot list reordered!');\n      } catch (error) {\n        console.error('Error reordering shots:', error);\n        toast.error('Failed to reorder shots');\n        setShotList(shotList); // Revert on error\n      }\n    }\n  };\n\n  const handleAddShot = async () => {\n    if (!newShotData.segment_name.trim() || !newShotData.script.trim()) {\n      toast.error('Please fill in shot name and script');\n      return;\n    }\n\n    try {\n      const result = await addShot(projectId, newShotData);\n      if (result.success) {\n        setShotList(result.shot_list);\n        setShowAddShot(false);\n        setNewShotData({\n          segment_name: '',\n          script: '',\n          visual_guide: '',\n          duration: 15\n        });\n        toast.success('Shot added successfully!');\n      }\n    } catch (error) {\n      console.error('Error adding shot:', error);\n      toast.error('Failed to add shot');\n    }\n  };\n\n  const handleFeedback = async (segmentName) => {\n    const msg = `Can you give me feedback on the ${segmentName.replace('_', ' ')} shot?`;\n    setInputValue(msg);\n    \n    setIsProcessing(true);\n    const userMessage = {\n      role: 'user',\n      content: msg,\n      timestamp: new Date()\n    };\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n    \n    try {\n      const result = await sendDirectorMessage(projectId, msg);\n      const aiMessage = {\n        role: 'assistant',\n        content: result.message,\n        timestamp: new Date()\n      };\n      setMessages(prev => [...prev, aiMessage]);\n      if (result.shot_list) setShotList(result.shot_list);\n    } catch (error) {\n      console.error('Error:', error);\n      toast.error('Failed to get feedback');\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-sky\">\n      {/* Navigation */}\n      <nav className=\"border-b border-border/50 bg-background/80 backdrop-blur-md sticky top-0 z-50\">\n        <div className=\"max-w-full px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center gap-4\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => navigate('/director')}\n                className=\"gap-2\"\n              >\n                <ChevronLeft className=\"w-4 h-4\" />\n                Back to Home\n              </Button>\n              <div className=\"h-6 w-px bg-border\"></div>\n              <Badge className=\"bg-primary/20 text-primary border-primary/30 font-sans animate-pulse\">\n                <Film className=\"w-3 h-3 mr-1\" />\n                Content Studio\n              </Badge>\n            </div>\n            <div className=\"flex items-center gap-4\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => navigate('/director/projects')}\n                className=\"gap-2\"\n              >\n                <FolderOpen className=\"w-4 h-4\" />\n                All Projects\n              </Button>\n              <UserMenu />\n            </div>\n          </div>\n        </div>\n      </nav>\n\n      {/* Split Screen Layout */}\n      <div className=\"flex h-[calc(100vh-4rem)]\">\n        \n        {/* Left Side - Shot List & Project Info */}\n        <div className=\"w-1/3 border-r border-border/50 bg-background/50 backdrop-blur-sm overflow-y-auto\">\n          <div className=\"p-6 space-y-6\">\n            \n            {/* Project Info */}\n            {project && (\n              <Card className=\"border-primary/30 bg-primary/5\">\n                <CardContent className=\"pt-4 pb-4\">\n                  <h3 className=\"text-sm font-semibold text-muted-foreground mb-2\">Project Goal</h3>\n                  <p className=\"text-sm text-foreground\">{extractCleanUserGoal(project.user_goal)}</p>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Matched Format */}\n            {matchedFormat && (\n              <Card className=\"border-accent/30 bg-accent/5\">\n                <CardContent className=\"pt-4 pb-4\">\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <Sparkles className=\"w-4 h-4 text-accent-foreground\" />\n                    <h3 className=\"text-sm font-semibold text-foreground\">Matched Format</h3>\n                  </div>\n                  <p className=\"text-sm font-semibold text-foreground mb-1\">{matchedFormat.name}</p>\n                  <p className=\"text-xs text-muted-foreground\">{matchedFormat.description}</p>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Shot List */}\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"text-lg font-semibold text-foreground\">Shot List</h3>\n                <div className=\"flex items-center gap-2\">\n                  <Badge variant=\"outline\" className=\"text-xs\">\n                    {shotList.filter(s => s.uploaded).length} / {shotList.length}\n                  </Badge>\n                  <Button\n                    size=\"sm\"\n                    onClick={() => setShowAddShot(true)}\n                    className=\"gap-1 h-7\"\n                  >\n                    <Plus className=\"w-4 h-4\" />\n                    Add Shot\n                  </Button>\n                </div>\n                \n                {/* Generate Final Video Button */}\n                {allSegmentsUploaded() && (\n                  <Card className=\"border-green-200 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/20 dark:to-emerald-950/20 dark:border-green-800\">\n                    <CardContent className=\"pt-6 pb-6\">\n                      <div className=\"space-y-4\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center\">\n                            <CheckCircle className=\"w-6 h-6 text-white\" />\n                          </div>\n                          <div>\n                            <h3 className=\"font-semibold text-foreground\">All Shots Complete!</h3>\n                            <p className=\"text-xs text-muted-foreground\">Ready to assemble your final video</p>\n                          </div>\n                        </div>\n                        \n                        {!isAssembling && !assemblyId && (\n                          <Button \n                            onClick={() => setShowAssemblyDialog(true)}\n                            className=\"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-semibold\"\n                            size=\"lg\"\n                          >\n                            <Clapperboard className=\"w-5 h-5 mr-2\" />\n                            Generate Final Video\n                          </Button>\n                        )}\n                        \n                        {isAssembling && (\n                          <div className=\"space-y-3\">\n                            <div className=\"flex items-center justify-between text-sm\">\n                              <span className=\"text-muted-foreground\">Assembling video...</span>\n                              <span className=\"font-semibold text-foreground\">{assemblyProgress}%</span>\n                            </div>\n                            <Progress value={assemblyProgress} className=\"h-2\" />\n                            <p className=\"text-xs text-muted-foreground\">\n                              {assemblyProgress < 30 && \"Processing segments...\"}\n                              {assemblyProgress >= 30 && assemblyProgress < 60 && \"Adding transitions...\"}\n                              {assemblyProgress >= 60 && assemblyProgress < 90 && \"Optimizing video...\"}\n                              {assemblyProgress >= 90 && \"Finalizing...\"}\n                            </p>\n                          </div>\n                        )}\n                        \n                        {assemblyStatus === 'completed' && assemblyId && (\n                          <Button \n                            onClick={handleDownloadVideo}\n                            className=\"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold\"\n                            size=\"lg\"\n                          >\n                            <Download className=\"w-5 h-5 mr-2\" />\n                            Download Final Video\n                          </Button>\n                        )}\n                      </div>\n                    </CardContent>\n                  </Card>\n                )}\n              </div>\n\n              {/* Add Shot Form */}\n              {showAddShot && (\n                <Card className=\"border-primary/30 bg-primary/5\">\n                  <CardContent className=\"pt-4 pb-4 space-y-3\">\n                    <h4 className=\"font-semibold text-sm\">Add New Shot</h4>\n                    <div className=\"space-y-2\">\n                      <Input\n                        placeholder=\"Shot name (e.g., hook, demo)\"\n                        value={newShotData.segment_name}\n                        onChange={(e) => setNewShotData({...newShotData, segment_name: e.target.value})}\n                        className=\"text-sm\"\n                      />\n                      <Textarea\n                        placeholder=\"Script for this shot\"\n                        value={newShotData.script}\n                        onChange={(e) => setNewShotData({...newShotData, script: e.target.value})}\n                        className=\"text-sm min-h-[60px]\"\n                      />\n                      <Textarea\n                        placeholder=\"Visual guide (how to film)\"\n                        value={newShotData.visual_guide}\n                        onChange={(e) => setNewShotData({...newShotData, visual_guide: e.target.value})}\n                        className=\"text-sm min-h-[60px]\"\n                      />\n                      <div className=\"flex items-center gap-2\">\n                        <label className=\"text-xs text-muted-foreground\">Duration (seconds):</label>\n                        <Input\n                          type=\"number\"\n                          value={newShotData.duration}\n                          onChange={(e) => setNewShotData({...newShotData, duration: parseInt(e.target.value)})}\n                          className=\"w-20 h-8 text-sm\"\n                        />\n                      </div>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Button size=\"sm\" onClick={handleAddShot} className=\"flex-1\">\n                        <Plus className=\"w-4 h-4 mr-1\" />\n                        Add Shot\n                      </Button>\n                      <Button \n                        size=\"sm\" \n                        variant=\"outline\" \n                        onClick={() => {\n                          setShowAddShot(false);\n                          setNewShotData({\n                            segment_name: '',\n                            script: '',\n                            visual_guide: '',\n                            duration: 15\n                          });\n                        }}\n                        className=\"flex-1\"\n                      >\n                        Cancel\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              )}\n              \n              {/* Sortable Shot List */}\n              {shotList.length > 0 && (\n                <DndContext\n                  sensors={sensors}\n                  collisionDetection={closestCenter}\n                  onDragEnd={handleDragEnd}\n                >\n                  <SortableContext\n                    items={shotList.map((shot, idx) => shot.segment_name + idx)}\n                    strategy={verticalListSortingStrategy}\n                  >\n                    <div className=\"space-y-3\">\n                      {shotList.map((shot, index) => (\n                        <SortableShotCard\n                          key={shot.segment_name + index}\n                          shot={shot}\n                          index={index}\n                          projectId={projectId}\n                          onUpdate={setShotList}\n                          onDelete={setShotList}\n                          uploadingSegment={uploadingSegment}\n                          handleSegmentUpload={handleSegmentUpload}\n                          handleFeedback={handleFeedback}\n                        />\n                      ))}\n                    </div>\n                  </SortableContext>\n                </DndContext>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Right Side - Chat */}\n        <div className=\"flex-1 flex flex-col\">\n          {/* Chat Messages */}\n          <div className=\"flex-1 overflow-y-auto p-6 space-y-4\">\n            {messages.map((message, index) => (\n              <div key={index} className={`flex gap-3 ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}>\n                {message.role === 'assistant' && (\n                  <Avatar className=\"w-10 h-10 border-2 border-primary/20 flex-shrink-0\">\n                    <AvatarFallback className=\"bg-gradient-primary text-primary-foreground\">\n                      <Sparkles className=\"w-5 h-5\" />\n                    </AvatarFallback>\n                  </Avatar>\n                )}\n                \n                <div className={`flex-1 max-w-2xl ${message.role === 'user' ? 'flex flex-col items-end' : ''}`}>\n                  <Card className={`${\n                    message.role === 'user' \n                      ? 'bg-primary text-primary-foreground border-primary' \n                      : 'bg-card/95 backdrop-blur-sm border-border/50'\n                  } shadow-lg`}>\n                    <CardContent className=\"pt-4 pb-4\">\n                      <div className=\"text-sm leading-relaxed whitespace-pre-wrap font-sans\">\n                        {message.role === 'assistant' ? markdownToPlainText(message.content) : message.content}\n                      </div>\n                    </CardContent>\n                  </Card>\n                  <span className=\"text-xs text-muted-foreground mt-1.5 font-sans\">\n                    {message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                  </span>\n                </div>\n\n                {message.role === 'user' && (\n                  <Avatar className=\"w-10 h-10 border-2 border-primary/20 flex-shrink-0\">\n                    <AvatarFallback className=\"bg-muted text-muted-foreground\">\n                      <User className=\"w-5 h-5\" />\n                    </AvatarFallback>\n                  </Avatar>\n                )}\n              </div>\n            ))}\n\n            {isProcessing && (\n              <div className=\"flex gap-3 justify-start\">\n                <Avatar className=\"w-10 h-10 border-2 border-primary/20\">\n                  <AvatarFallback className=\"bg-gradient-primary text-primary-foreground\">\n                    <Sparkles className=\"w-5 h-5\" />\n                  </AvatarFallback>\n                </Avatar>\n                <Card className=\"bg-card/95 backdrop-blur-sm border-border/50 shadow-lg\">\n                  <CardContent className=\"pt-4 pb-4\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"flex gap-1\">\n                        <div className=\"w-2 h-2 rounded-full bg-primary animate-bounce\" style={{ animationDelay: '0s' }}></div>\n                        <div className=\"w-2 h-2 rounded-full bg-primary animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\n                        <div className=\"w-2 h-2 rounded-full bg-primary animate-bounce\" style={{ animationDelay: '0.4s' }}></div>\n                      </div>\n                      <span className=\"text-sm text-muted-foreground font-sans\">Thinking...</span>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            )}\n            <div ref={messagesEndRef} />\n          </div>\n\n          {/* Input Area */}\n          <div className=\"border-t border-border/50 bg-background/80 backdrop-blur-sm p-6\">\n            {/* Quick Actions */}\n            {shotList.length > 0 && (\n              <div className=\"flex flex-wrap gap-2 mb-4\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => {\n                    setInputValue(\"Please provide a comprehensive project status. Include: 1) Overall creative vision and format we're using, 2) Complete shot list with what's been filmed and what's remaining, 3) Quality assessment of uploaded shots so far, 4) Any creative adjustments or suggestions based on progress, 5) Estimated completion percentage and next steps.\");\n                    textareaRef.current?.focus();\n                  }}\n                  className=\"text-xs\"\n                >\n                  ðŸ“Š Project Status\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => {\n                    setInputValue(\"Please explain the next shot I need to record. Include: 1) Which shot it is in the sequence, 2) What the script and visual guide are for this shot, 3) Any specific tips or techniques for filming this shot effectively, 4) How this shot fits into the overall narrative. Do I have any questions before I start filming?\");\n                    textareaRef.current?.focus();\n                  }}\n                  className=\"text-xs\"\n                >\n                  ðŸŽ¥ Next Shot\n                </Button>\n                {shotList.some(s => s.uploaded) && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => {\n                      setInputValue(\"Can you review all my uploaded shots?\");\n                      textareaRef.current?.focus();\n                    }}\n                    className=\"text-xs\"\n                  >\n                    âœ¨ Review Uploads\n                  </Button>\n                )}\n              </div>\n            )}\n            \n            <Card className=\"border-border/50 shadow-xl bg-card/95 backdrop-blur-sm\">\n              <CardContent className=\"pt-4 pb-4\">\n                <div className=\"flex gap-2\">\n                  <Textarea\n                    ref={textareaRef}\n                    value={inputValue}\n                    onChange={(e) => setInputValue(e.target.value)}\n                    onKeyDown={handleKeyDown}\n                    placeholder=\"Ask me anything about your video or tell me you're ready to record...\"\n                    className=\"min-h-[80px] resize-none focus:ring-primary font-sans text-base\"\n                    disabled={isProcessing}\n                  />\n                  <Button\n                    onClick={handleSendMessage}\n                    disabled={isProcessing || !inputValue.trim()}\n                    className=\"bg-gradient-primary hover:shadow-glow self-end px-5 h-[80px] transition-all duration-300\"\n                  >\n                    <Send className=\"w-5 h-5\" />\n                  </Button>\n                </div>\n                <p className=\"text-xs text-muted-foreground mt-2 font-sans\">\n                  Press <kbd className=\"px-2 py-1 bg-muted rounded text-xs\">âŒ˜ Enter</kbd> to send\n                </p>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n\n      {/* Assembly Configuration Dialog */}\n      <Dialog open={showAssemblyDialog} onOpenChange={setShowAssemblyDialog}>\n        <DialogContent className=\"sm:max-w-[600px]\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Settings className=\"w-5 h-5\" />\n              Configure Video Assembly\n            </DialogTitle>\n            <DialogDescription>\n              Customize how your final video will be assembled. Add transitions, subtitles, and optimize for your target platform.\n            </DialogDescription>\n          </DialogHeader>\n          \n          <div className=\"space-y-6 py-4\">\n            \n            {/* Transitions */}\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label htmlFor=\"transitions\" className=\"text-base font-semibold\">Add Transitions</Label>\n                  <p className=\"text-sm text-muted-foreground\">Smooth transitions between shots</p>\n                </div>\n                <Switch\n                  id=\"transitions\"\n                  checked={assemblyOptions.add_transitions}\n                  onCheckedChange={(checked) => \n                    setAssemblyOptions(prev => ({ ...prev, add_transitions: checked }))\n                  }\n                />\n              </div>\n              \n              {assemblyOptions.add_transitions && (\n                <div className=\"grid grid-cols-2 gap-4 pl-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"transition-type\">Transition Type</Label>\n                    <Select\n                      value={assemblyOptions.transition_type}\n                      onValueChange={(value) => \n                        setAssemblyOptions(prev => ({ ...prev, transition_type: value }))\n                      }\n                    >\n                      <SelectTrigger id=\"transition-type\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"fade\">Fade</SelectItem>\n                        <SelectItem value=\"wipe\">Wipe</SelectItem>\n                        <SelectItem value=\"dissolve\">Dissolve</SelectItem>\n                        <SelectItem value=\"slidedown\">Slide Down</SelectItem>\n                        <SelectItem value=\"slideup\">Slide Up</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"transition-duration\">Duration (seconds)</Label>\n                    <input\n                      id=\"transition-duration\"\n                      type=\"number\"\n                      min=\"0.1\"\n                      max=\"2\"\n                      step=\"0.1\"\n                      value={assemblyOptions.transition_duration}\n                      onChange={(e) => \n                        setAssemblyOptions(prev => ({ \n                          ...prev, \n                          transition_duration: parseFloat(e.target.value) \n                        }))\n                      }\n                      className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                    />\n                  </div>\n                </div>\n              )}\n            </div>\n\n            <div className=\"border-t pt-4\" />\n            \n            {/* Subtitles */}\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label htmlFor=\"subtitles\" className=\"text-base font-semibold\">Add Subtitles</Label>\n                  <p className=\"text-sm text-muted-foreground\">Auto-generated from shot scripts</p>\n                </div>\n                <Switch\n                  id=\"subtitles\"\n                  checked={assemblyOptions.add_subtitles}\n                  onCheckedChange={(checked) => \n                    setAssemblyOptions(prev => ({ ...prev, add_subtitles: checked }))\n                  }\n                />\n              </div>\n              \n              {assemblyOptions.add_subtitles && (\n                <div className=\"grid grid-cols-2 gap-4 pl-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"subtitle-position\">Position</Label>\n                    <Select\n                      value={assemblyOptions.subtitle_position}\n                      onValueChange={(value) => \n                        setAssemblyOptions(prev => ({ ...prev, subtitle_position: value }))\n                      }\n                    >\n                      <SelectTrigger id=\"subtitle-position\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"top\">Top</SelectItem>\n                        <SelectItem value=\"center\">Center</SelectItem>\n                        <SelectItem value=\"bottom\">Bottom</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"subtitle-size\">Font Size</Label>\n                    <input\n                      id=\"subtitle-size\"\n                      type=\"number\"\n                      min=\"24\"\n                      max=\"72\"\n                      step=\"4\"\n                      value={assemblyOptions.subtitle_font_size}\n                      onChange={(e) => \n                        setAssemblyOptions(prev => ({ \n                          ...prev, \n                          subtitle_font_size: parseInt(e.target.value) \n                        }))\n                      }\n                      className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                    />\n                  </div>\n                </div>\n              )}\n            </div>\n\n            <div className=\"border-t pt-4\" />\n            \n            {/* Platform Optimization */}\n            <div className=\"space-y-3\">\n              <div>\n                <Label htmlFor=\"platform\" className=\"text-base font-semibold\">Optimize for Platform</Label>\n                <p className=\"text-sm text-muted-foreground mb-3\">Adjust resolution and format for best results</p>\n              </div>\n              \n              <Select\n                value={assemblyOptions.optimize_platform}\n                onValueChange={(value) => \n                  setAssemblyOptions(prev => ({ ...prev, optimize_platform: value }))\n                }\n              >\n                <SelectTrigger id=\"platform\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"youtube\">\n                    <div className=\"flex items-center gap-2\">\n                      <Video className=\"w-4 h-4\" />\n                      YouTube (1920x1080, 16:9)\n                    </div>\n                  </SelectItem>\n                  <SelectItem value=\"tiktok\">\n                    <div className=\"flex items-center gap-2\">\n                      <Film className=\"w-4 h-4\" />\n                      TikTok (1080x1920, 9:16)\n                    </div>\n                  </SelectItem>\n                  <SelectItem value=\"instagram\">\n                    <div className=\"flex items-center gap-2\">\n                      <Film className=\"w-4 h-4\" />\n                      Instagram Reels (1080x1920, 9:16)\n                    </div>\n                  </SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setShowAssemblyDialog(false)}>\n              Cancel\n            </Button>\n            <Button \n              onClick={() => {\n                setShowAssemblyDialog(false);\n                handleStartAssembly();\n              }}\n              className=\"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white\"\n            >\n              <Clapperboard className=\"w-4 h-4 mr-2\" />\n              Start Assembly\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}